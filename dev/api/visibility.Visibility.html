

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Visibility &mdash; SoHAPPy 0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Monte Carlo" href="../montecarlo.html" />
    <link rel="prev" title="Visibilities" href="../visibility.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> SoHAPPy
          

          
          </a>

          
            
            
              <div class="version">
                dev
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sohappy.html">How it works ?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Configuration file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../irf.html">Instrument response functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../file_format.html">Input file format</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Concepts and classes</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../grb.html">Astrophysical objects (GRB)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../time_slice.html">Time slices and slots</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../visibility.html">Visibilities</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../visibility.html#module-visibility">visibility Module</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../visibility.html#classes">Classes</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">Visibility</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../montecarlo.html">Monte Carlo</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Analysis</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../population_analysis.html">Population analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source_analysis.html">Analyzing a single object</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source_analysis.html#dataset-plotting">Dataset plotting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tools.html">Dataset tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools.html#utilities">Utilities</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">The developer corner</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developer.html">Todo list</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SoHAPPy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../visibility.html">Visibilities</a> &raquo;</li>
        
      <li>Visibility</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/api/visibility.Visibility.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="visibility">
<h1>Visibility<a class="headerlink" href="#visibility" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="visibility.Visibility">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">visibility.</span></span><span class="sig-name descname"><span class="pre">Visibility</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observatory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CTA'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/visibility.html#Visibility"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#visibility.Visibility" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>This class defines the visibility periods for a given GRB and a certain
site (North or South).
It can be called to update the default visibilities given with the GRB data
file, in particular to modify the minimum altitude for a source to be
decently detectable.
The method, <a class="reference internal" href="#visibility.Visibility.check" title="visibility.Visibility.check"><code class="xref py py-class docutils literal notranslate"><span class="pre">check</span></code></a> is used to compare the visibility
windows with the one given by default in the GRB file or any other
pre-loaded visibility.</p>
<p>Excerpt from the astroplan documentation:</p>
<ul class="simple">
<li><p>Moonrise is defined as the instant when, in the eastern sky, under ideal meteorological conditions, with standard refraction of the Moon’s rays, the upper edge of the Moon’s disk is coincident with an ideal horizon.</p></li>
<li><p>Moonset is defined as the instant when, in the western sky, under ideal meteorological conditions, with standard refraction of the Moon’s rays, the upper edge of the Moon’s disk is coincident with an ideal horizon.</p></li>
</ul>
<p>The Moon angular diameter varies between 29.3 to 34.1 arcminutes 
(Wikipedia), namely 0.488 and 0.568 degree. The rise time is when the moon is below the horizon at a negative angle half of these values, respectively -0.244 and -0.284 degree</p>
<p class="rubric">Methods Summary</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#visibility.Visibility.check" title="visibility.Visibility.check"><code class="xref py py-obj docutils literal notranslate"><span class="pre">check</span></code></a>(view[, loc, delta_max, log])</p></td>
<td><p>Checks whether the visibility found in this code is identical to the one in argument.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#visibility.Visibility.compute" title="visibility.Visibility.compute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute</span></code></a>(grb, loc[, observatory, altmin, ...])</p></td>
<td><p>Compute the visibility periods for a given GRB and site.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#visibility.Visibility.from_fits" title="visibility.Visibility.from_fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_fits</span></code></a>(grb, hdr, hdul[, hdu, loc])</p></td>
<td><p>Default visibility from input file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#visibility.Visibility.horizon" title="visibility.Visibility.horizon"><code class="xref py py-obj docutils literal notranslate"><span class="pre">horizon</span></code></a>(obs[, npt])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#visibility.Visibility.moon_alt_veto" title="visibility.Visibility.moon_alt_veto"><code class="xref py py-obj docutils literal notranslate"><span class="pre">moon_alt_veto</span></code></a>(obs[, npt])</p></td>
<td><p>The first veto is the moon alitude.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#visibility.Visibility.moon_halo" title="visibility.Visibility.moon_halo"><code class="xref py py-obj docutils literal notranslate"><span class="pre">moon_halo</span></code></a>([r0, rc, epsilon, q0])</p></td>
<td><p>Returns the moon light intensity (hand-made model) as a function of distance r It is assumed that the intensity is constant (q0) along the moon radius r0, and reach the fraction epsilon at the critical distance rc, following a 1/r2 function: 1/(a*(x-r0)**2 +c)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#visibility.Visibility.moon_halo_veto" title="visibility.Visibility.moon_halo_veto"><code class="xref py py-obj docutils literal notranslate"><span class="pre">moon_halo_veto</span></code></a>([threshold, r0, rc, epsilon])</p></td>
<td><p>Returns the distance at which the moon intensity reaches the threshold This is the analytical inverse of the moon_halo function</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#visibility.Visibility.moonlight_veto" title="visibility.Visibility.moonlight_veto"><code class="xref py py-obj docutils literal notranslate"><span class="pre">moonlight_veto</span></code></a>(dt[, debug])</p></td>
<td><p>Check if the Moon period defined by the rise and set time correspond to a situation where the moon is too bright or too close from the source.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#visibility.Visibility.nights" title="visibility.Visibility.nights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nights</span></code></a>(obs[, skip, npt])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#visibility.Visibility.print" title="visibility.Visibility.print"><code class="xref py py-obj docutils literal notranslate"><span class="pre">print</span></code></a>([log, alt])</p></td>
<td><p>Print out the GRB night, above-the-horizon periods, and default visibility window.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#visibility.Visibility.read" title="visibility.Visibility.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read</span></code></a>(name[, folder, debug])</p></td>
<td><p>Read a visibility instance from disk</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#visibility.Visibility.write" title="visibility.Visibility.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write</span></code></a>([folder, debug])</p></td>
<td><p>Write current visibility instance to disk</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods Documentation</p>
<dl class="py method">
<dt class="sig sig-object py" id="visibility.Visibility.check">
<span class="sig-name descname"><span class="pre">check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">view</span></em>, <em class="sig-param"><span class="pre">loc=None</span></em>, <em class="sig-param"><span class="pre">delta_max=&lt;Quantity</span> <span class="pre">5.</span> <span class="pre">s&gt;</span></em>, <em class="sig-param"><span class="pre">log=None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/visibility.html#Visibility.check"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#visibility.Visibility.check" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether the visibility found in this code is
identical to the one in argument.
In particular, allow checking the default visbility for altmin=10°
and one night (The computation was done by maria Grazia Bernardini (MGB).
See README file for more information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>vis: Visibility</strong></dt><dd><p>The visibility to be compared wiht</p>
</dd>
<dt><strong>delta_max</strong><span class="classifier">float, optional</span></dt><dd><p>Max tolerance in seconds on window time limits.
The default is 5..</p>
</dd>
<dt><strong>log</strong><span class="classifier">file pointer, optional</span></dt><dd><p>Allows having the output both on screen and in a file. The default is None.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="visibility.Visibility.compute">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">grb</span></em>, <em class="sig-param"><span class="pre">loc</span></em>, <em class="sig-param"><span class="pre">observatory='CTA'</span></em>, <em class="sig-param"><span class="pre">altmin=&lt;Quantity</span> <span class="pre">10.</span> <span class="pre">deg&gt;</span></em>, <em class="sig-param"><span class="pre">altmoon=&lt;Quantity</span> <span class="pre">0.</span> <span class="pre">deg&gt;</span></em>, <em class="sig-param"><span class="pre">moondist=&lt;Quantity</span> <span class="pre">0.</span> <span class="pre">deg&gt;</span></em>, <em class="sig-param"><span class="pre">moonlight=1</span></em>, <em class="sig-param"><span class="pre">depth=3</span></em>, <em class="sig-param"><span class="pre">skip=0</span></em>, <em class="sig-param"><span class="pre">npt=150</span></em>, <em class="sig-param"><span class="pre">force_vis=False</span></em>, <em class="sig-param"><span class="pre">debug=True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/visibility.html#Visibility.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#visibility.Visibility.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the visibility periods for a given GRB and site. This constructor takes as arguments a grb (:class:’GammaRayBurst`) and a location (string), and all the parameters required for the computation.</p>
<p>Note that all time variables are expressed in Julian days (to use <cite>sort</cite>) an are then copied as <code class="xref py py-class docutils literal notranslate"><span class="pre">Time</span></code> objects later into the class variables.</p>
<p>The algorithm is the following:</p>
<blockquote>
<div><ol class="arabic simple">
<li><dl class="simple">
<dt>Build periods for:</dt><dd><ul class="simple">
<li><p>Nights (<em>t_night</em>), and check if trigger occurs during night (<em>is_night</em>);</p></li>
<li><p>Potential moon vetoes (<em>t_moon_alt_veto</em>) due to the Moon above the defined horizon (<em>altmoon</em>);</p></li>
<li><p>Check (<em>True</em>, <em>False</em>) whether these Moon veto periods are kept by the moon brightness and distance to the source (<em>moonlight_veto</em>). If this is the case, keep the corresponding moon veto period in <em>t_moon_veto</em> otherwise discard the period. In order to have all Moon period kept (i.e. veto is valid as soon as Moon is above <em>altmoon</em>), <em>moondist</em> should be maximised (veto at any distance) and <em>moonlight</em> should be minimised (even if no moonligt, veto is valid);</p></li>
<li><p>Above horizon (<em>t_above</em>) and whether the object is above the horizon (<em>altmin</em>) at trigger time.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Put all <em>start</em> and <em>stop</em> of all these periods in a list, sort the list, resulting in a series of ordered “ticks”.</p></li>
<li><dl class="simple">
<dt>For each consecutive tick pairs in the list:</dt><dd><ul class="simple">
<li><p>Compute the mean time (middle of the a tick pair)</p></li>
<li><p>Check if that time belongs to one of the <em>night</em>, <em>above</em>, or <em>bright</em> (i.e. in the available data interval) intervals and not to any  <em>moon</em> interval. If so get True, otherwise False.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>For each of the tick pairs compute the Boolean <cite>visible = bright and dark and above and moon</cite> and get the visibility windows when True.</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>altmin</strong><span class="classifier">float, optional</span></dt><dd><p>Minimum altitude. The default is 10*u.deg.</p>
</dd>
<dt><strong>depth</strong><span class="classifier">Quantity Time, optional</span></dt><dd><p>Depth up to which time windows are search for (at least one day). The default is 3 days, and the reference time is the start of the visibility window (i.e. the window end can be beyond the depth)</p>
</dd>
<dt><strong>end</strong><span class="classifier">integer, optional</span></dt><dd><p>Defines the crietria to accept a visibility window within the depth. If 0, the window has to start before depth, if 1 it has to stop before depth.</p>
</dd>
<dt><strong>npt</strong><span class="classifier">integer, optional</span></dt><dd><p>Number of grid points for horizon crossing. The default is 150.</p>
</dd>
<dt><strong>debug</strong><span class="classifier">bool, optional</span></dt><dd><p>Print additional comments at excecution time if True .The default is False.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="visibility.Visibility.from_fits">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">from_fits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdul</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'None'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/visibility.html#Visibility.from_fits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#visibility.Visibility.from_fits" title="Permalink to this definition">¶</a></dt>
<dd><p>Default visibility from input file.</p>
<ul class="simple">
<li><p>The start and stop dates are searched during 24h after the trigger and correspond to the first visibility interval.</p></li>
<li><p>Does not report a second visibility interval during 24h, that should be possible only if the target is promptly visible (about 15% of the targets)</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>grb</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
<dt><strong>hdr</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
<dt><strong>hdul</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
<dt><strong>hdu</strong><span class="classifier">TYPE, optional</span></dt><dd><p>DESCRIPTION. The default is 1.</p>
</dd>
<dt><strong>loc</strong><span class="classifier">TYPE, optional</span></dt><dd><p>DESCRIPTION. The default is “None”.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="visibility.Visibility.horizon">
<span class="sig-name descname"><span class="pre">horizon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/visibility.html#Visibility.horizon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#visibility.Visibility.horizon" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>obs</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
<dt><strong>npt</strong><span class="classifier">TYPE, optional</span></dt><dd><p>DESCRIPTION. The default is 150.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>high</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
<dt>TYPE</dt><dd><p>DESCRIPTION.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="visibility.Visibility.moon_alt_veto">
<span class="sig-name descname"><span class="pre">moon_alt_veto</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/visibility.html#Visibility.moon_alt_veto"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#visibility.Visibility.moon_alt_veto" title="Permalink to this definition">¶</a></dt>
<dd><p>The first veto is the moon alitude.
First find windows where the Moon is too high</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>obs</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
<dt><strong>twindow</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
<dt><strong>altmin</strong><span class="classifier">TYPE, optional</span></dt><dd><p>DESCRIPTION. The default is 10*u.deg.</p>
</dd>
<dt><strong>npt</strong><span class="classifier">TYPE, optional</span></dt><dd><p>DESCRIPTION. The default is 150.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>tmoons</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="visibility.Visibility.moon_halo">
<span class="sig-name descname"><span class="pre">moon_halo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/visibility.html#Visibility.moon_halo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#visibility.Visibility.moon_halo" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the moon light intensity (hand-made model) as a function of distance r
It is assumed that the intensity is constant (q0) along the moon radius r0, and reach
the fraction epsilon at the critical distance rc, following a 1/r2 function:
1/(a*(x-r0)**2 +c)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="visibility.Visibility.moon_halo_veto">
<span class="sig-name descname"><span class="pre">moon_halo_veto</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/visibility.html#Visibility.moon_halo_veto"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#visibility.Visibility.moon_halo_veto" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the distance at which the moon intensity reaches the threshold
This is the analytical inverse of the moon_halo function</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="visibility.Visibility.moonlight_veto">
<span class="sig-name descname"><span class="pre">moonlight_veto</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/visibility.html#Visibility.moonlight_veto"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#visibility.Visibility.moonlight_veto" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the Moon period defined by the rise and set time correspond
to a situation where the moon is too bright or too close from the
source.
If this is the case (too bright or too close), returns True
(the veto is confirmed).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="visibility.Visibility.nights">
<span class="sig-name descname"><span class="pre">nights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/visibility.html#Visibility.nights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#visibility.Visibility.nights" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>obs</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
<dt><strong>is_night</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
<dt><strong>skip</strong><span class="classifier">TYPE, optional</span></dt><dd><p>DESCRIPTION. The default is 0.</p>
</dd>
<dt><strong>tstop</strong><span class="classifier">TYPE, optional</span></dt><dd><p>DESCRIPTION. The default is None.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>tnights</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="visibility.Visibility.print">
<span class="sig-name descname"><span class="pre">print</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/visibility.html#Visibility.print"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#visibility.Visibility.print" title="Permalink to this definition">¶</a></dt>
<dd><p>Print out the GRB night, above-the-horizon periods, and default
visibility window.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>loc</strong><span class="classifier">String, optional</span></dt><dd><p>Either “North” or “South”. The default is None.</p>
</dd>
<dt><strong>log</strong><span class="classifier">TextIO, optional</span></dt><dd><p>Log file. The default is None.</p>
</dd>
<dt><strong>alt</strong><span class="classifier">Visibility instance</span></dt><dd><p>Get the values from the Visibility object (used for comparisons)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="visibility.Visibility.read">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">read</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/visibility.html#Visibility.read"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#visibility.Visibility.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a visibility instance from disk</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>cls</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
<dt><strong>name</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
<dt><strong>folder</strong><span class="classifier">TYPE, optional</span></dt><dd><p>DESCRIPTION. The default is “.”.</p>
</dd>
<dt><strong>debug</strong><span class="classifier">TYPE, optional</span></dt><dd><p>DESCRIPTION. The default is False.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>vis</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="visibility.Visibility.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/visibility.html#Visibility.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#visibility.Visibility.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write current visibility instance to disk</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>folder</strong><span class="classifier">TYPE, optional</span></dt><dd><p>DESCRIPTION. The default is “.”.</p>
</dd>
<dt><strong>debug</strong><span class="classifier">TYPE, optional</span></dt><dd><p>DESCRIPTION. The default is False.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../montecarlo.html" class="btn btn-neutral float-right" title="Monte Carlo" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="../visibility.html" class="btn btn-neutral float-left" title="Visibilities" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Th. Stolarczyk.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>