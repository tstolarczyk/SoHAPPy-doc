

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Visibilities &mdash; SoHAPPy 0.9 beta documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="_static/plot_directive.css?v=7f9a90b1" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=88ef157a"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            SoHAPPy
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Visibilities</a><ul>
<li><a class="reference internal" href="#parameter-file">Parameter file</a></li>
<li><a class="reference internal" href="#the-visibility-module">The <cite>visibility</cite> module</a><ul>
<li><a class="reference internal" href="#visibility.Visibility"><code class="docutils literal notranslate"><span class="pre">Visibility</span></code></a><ul>
<li><a class="reference internal" href="#visibility.Visibility.__init__"><code class="docutils literal notranslate"><span class="pre">Visibility.__init__()</span></code></a></li>
<li><a class="reference internal" href="#visibility.Visibility.check"><code class="docutils literal notranslate"><span class="pre">Visibility.check()</span></code></a></li>
<li><a class="reference internal" href="#visibility.Visibility.compute"><code class="docutils literal notranslate"><span class="pre">Visibility.compute()</span></code></a></li>
<li><a class="reference internal" href="#visibility.Visibility.def_vis_dicts"><code class="docutils literal notranslate"><span class="pre">Visibility.def_vis_dicts</span></code></a></li>
<li><a class="reference internal" href="#visibility.Visibility.force_night"><code class="docutils literal notranslate"><span class="pre">Visibility.force_night()</span></code></a></li>
<li><a class="reference internal" href="#visibility.Visibility.from_dict"><code class="docutils literal notranslate"><span class="pre">Visibility.from_dict()</span></code></a></li>
<li><a class="reference internal" href="#visibility.Visibility.from_fits"><code class="docutils literal notranslate"><span class="pre">Visibility.from_fits()</span></code></a></li>
<li><a class="reference internal" href="#visibility.Visibility.horizon"><code class="docutils literal notranslate"><span class="pre">Visibility.horizon()</span></code></a></li>
<li><a class="reference internal" href="#visibility.Visibility.ignore"><code class="docutils literal notranslate"><span class="pre">Visibility.ignore</span></code></a></li>
<li><a class="reference internal" href="#visibility.Visibility.moon_alt_veto"><code class="docutils literal notranslate"><span class="pre">Visibility.moon_alt_veto()</span></code></a></li>
<li><a class="reference internal" href="#visibility.Visibility.moon_halo"><code class="docutils literal notranslate"><span class="pre">Visibility.moon_halo()</span></code></a></li>
<li><a class="reference internal" href="#visibility.Visibility.moon_halo_veto"><code class="docutils literal notranslate"><span class="pre">Visibility.moon_halo_veto()</span></code></a></li>
<li><a class="reference internal" href="#visibility.Visibility.moonlight_veto"><code class="docutils literal notranslate"><span class="pre">Visibility.moonlight_veto()</span></code></a></li>
<li><a class="reference internal" href="#visibility.Visibility.nights"><code class="docutils literal notranslate"><span class="pre">Visibility.nights()</span></code></a></li>
<li><a class="reference internal" href="#visibility.Visibility.object_to_serializable"><code class="docutils literal notranslate"><span class="pre">Visibility.object_to_serializable()</span></code></a></li>
<li><a class="reference internal" href="#visibility.Visibility.params_from_key"><code class="docutils literal notranslate"><span class="pre">Visibility.params_from_key()</span></code></a></li>
<li><a class="reference internal" href="#visibility.Visibility.period_plot"><code class="docutils literal notranslate"><span class="pre">Visibility.period_plot()</span></code></a></li>
<li><a class="reference internal" href="#visibility.Visibility.plot"><code class="docutils literal notranslate"><span class="pre">Visibility.plot()</span></code></a></li>
<li><a class="reference internal" href="#visibility.Visibility.print"><code class="docutils literal notranslate"><span class="pre">Visibility.print()</span></code></a></li>
<li><a class="reference internal" href="#visibility.Visibility.summary"><code class="docutils literal notranslate"><span class="pre">Visibility.summary()</span></code></a></li>
<li><a class="reference internal" href="#visibility.Visibility.to_json"><code class="docutils literal notranslate"><span class="pre">Visibility.to_json()</span></code></a></li>
<li><a class="reference internal" href="#visibility.Visibility.valid"><code class="docutils literal notranslate"><span class="pre">Visibility.valid()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#the-moon-module">The <cite>moon</cite> module</a></li>
<li><a class="reference internal" href="#module-moon">moon Module</a><ul>
<li><a class="reference internal" href="#functions">Functions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-observatory-module">The <cite>observatory</cite> module</a></li>
<li><a class="reference internal" href="#module-observatory">observatory Module</a><ul>
<li><a class="reference internal" href="#variables">Variables</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SoHAPPy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Visibilities</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/visibility.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="visibilities">
<h1>Visibilities<a class="headerlink" href="#visibilities" title="Link to this heading"></a></h1>
<p>The time slices and slots are derived from the original <em>fits</em> file slices after computing when the source is visible.</p>
<dl>
<dt>For each site location, the visibility depends on:</dt><dd><ul>
<li><p>the abscence of Sun (astronomical twilight, Sun below -18°);</p></li>
<li><p>the altitude of the object above the horizon (The usual minimal
value is 24° following the CTA requirements);</p></li>
<li><p>the presence of Moon light as defined by :</p>
<blockquote>
<div><ul class="simple">
<li><p>the Moon alitude in the sky;</p></li>
<li><p>the moon phase (or illumination, between 0 and 1);</p></li>
<li><p>the angular distance of the object to the Moon.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</dd>
</dl>
<p>All this is obtained from functions in the
<a class="reference external" href="https://astroplan.readthedocs.io/en/v0.10/">astroplan package</a>.</p>
<p>The visibility is defined by the <a class="reference internal" href="#visibility.Visibility" title="visibility.Visibility"><code class="xref py py-class docutils literal notranslate"><span class="pre">visibility.Visibility</span></code></a> class in <code class="file docutils literal notranslate"><span class="pre">visibility.py</span></code>. It is either read from original provided data (<a class="reference internal" href="#visibility.Visibility.from_fits" title="visibility.Visibility.from_fits"><code class="xref py py-func docutils literal notranslate"><span class="pre">visibility.Visibility.from_fits()</span></code></a>) or pre-computed values (<code class="xref py py-func docutils literal notranslate"><span class="pre">visibility.Visibility.read()</span></code>), or computed on the fly (<a class="reference internal" href="#visibility.Visibility.compute" title="visibility.Visibility.compute"><code class="xref py py-func docutils literal notranslate"><span class="pre">visibility.Visibility.compute()</span></code></a>). In that case the visibility parameters are read from a <cite>visibility.yaml</cite> file in the <cite>SoHAPPy</cite> local folder (see below)
Once computed it can be save on disk (<code class="xref py py-func docutils literal notranslate"><span class="pre">visibility.Visibility.write()</span></code>) to be further re-used.</p>
<p>The visibility consists in time periods that will be applied to the original object time slices to create new time slices on which the observation will be simulated. <em>It does not account for the delay due to the alert or the telescope slewing</em> so that it can be re-used to studies the effect of these delays.</p>
<p>A function (<a class="reference internal" href="#visibility.Visibility.check" title="visibility.Visibility.check"><code class="xref py py-func docutils literal notranslate"><span class="pre">visibility.Visibility.check()</span></code></a>) allows comparing two visibilities obtained in different ways and give the compatibility of the two within a time difference.</p>
<section id="parameter-file">
<h2>Parameter file<a class="headerlink" href="#parameter-file" title="Link to this heading"></a></h2>
<p>The visibility parameters are stored in a dedicated <code class="file docutils literal notranslate"><span class="pre">visibility.yaml</span></code> file. They are used when the SoHAPPy configuration file (the default is <code class="file docutils literal notranslate"><span class="pre">config.yaml</span></code>) requires that the visibility are recomputed on the fly.
In that case the visibility entry takes one of these parameters:</p>
<ul class="simple">
<li><p><strong>strictmoonveto</strong> : the source can be considered visible only if the Moon is below the horizon (altitude less than 0.25°). <strong>skip_first_strictmoonveto</strong> and <strong>skip_second_strictmoonveto</strong> skip the first and the two first nights respectively.</p></li>
<li><p><strong>nomoonveto</strong> : the source can be considered visible even if the Moon is above the horizon whatever its distance to the source or it phase.</p></li>
<li><p><strong>moonlight</strong> : the source can be considered visible if the moon phase is small enough and the distance to the source large enough.</p></li>
<li><p><strong>alwaysvisible</strong> : the source is visible as soon as it is abovethe horizon (no altitude lower limit) and the Moon is ignored (Unrealistic, used to explore the parameter space coverage).</p></li>
</ul>
<p>The visibility parameters are the following (example given for <cite>strictmoonveto</cite>):</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>variable</p></th>
<th class="head"><p>Default for <cite>moonlight</cite></p></th>
<th class="head"><p>What is it ?</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>where</p></td>
<td><p>“CTAO”</p></td>
<td><p>Observatory position keyword</p></td>
</tr>
<tr class="row-odd"><td><p>depth</p></td>
<td><p>3</p></td>
<td><p>Max. number of nights</p></td>
</tr>
<tr class="row-even"><td><p>skip</p></td>
<td><p>0</p></td>
<td><p>Number of first nights to be skipped</p></td>
</tr>
<tr class="row-odd"><td><p>altmin</p></td>
<td><p>24 deg</p></td>
<td><p>Minimum altitude</p></td>
</tr>
<tr class="row-even"><td><p>altmoon</p></td>
<td><p>-0.25 deg   (horizon)</p></td>
<td><p>Moon maximum altitude</p></td>
</tr>
<tr class="row-odd"><td><p>moondist</p></td>
<td><p>30 deg</p></td>
<td><p>Moon minimal distance</p></td>
</tr>
<tr class="row-even"><td><p>moonlight</p></td>
<td><p>0.6</p></td>
<td><p>Moon maximum brigthness</p></td>
</tr>
</tbody>
</table>
</section>
<section id="the-visibility-module">
<h2>The <cite>visibility</cite> module<a class="headerlink" href="#the-visibility-module" title="Link to this heading"></a></h2>
<p>This module contains only the <a class="reference internal" href="#visibility.Visibility" title="visibility.Visibility"><code class="xref py py-class docutils literal notranslate"><span class="pre">visibility.Visibility</span></code></a> class and a
main function with examples.</p>
<dl class="py class">
<dt class="sig sig-object py" id="visibility.Visibility">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">visibility.</span></span><span class="sig-name descname"><span class="pre">Visibility</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos=&lt;SkyCoord</span> <span class="pre">(ICRS):</span> <span class="pre">(ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec)</span> <span class="pre">in</span> <span class="pre">deg</span>&#160;&#160;&#160;&#160; <span class="pre">(0.</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">0.)&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmin=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmax=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth=3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">status='Empty'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name='Dummy'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/visibility.html#Visibility"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#visibility.Visibility" title="Link to this definition"></a></dt>
<dd><p>Define visibility periods for a given GRB and a given site (N or S).</p>
<p>The method, <a class="reference internal" href="#visibility.Visibility.check" title="visibility.Visibility.check"><code class="xref py py-class docutils literal notranslate"><span class="pre">check</span></code></a> is used to compare the visibility
windows with the one given by default in the GRB file or any other
pre-loaded visibility.</p>
<p>Excerpt from the astroplan documentation:</p>
<ul class="simple">
<li><p>Moonrise is defined as the instant when, in the eastern sky, under ideal
meteorological conditions, with standard refraction of the Moon’s rays,
the upper edge of the Moon’s disk is coincident with an ideal horizon.</p></li>
<li><p>Moonset is defined as the instant when, in the western sky, under ideal
meteorological conditions, with standard refraction of the Moon’s rays,
the upper edge of the Moon’s disk is coincident with an ideal horizon.</p></li>
</ul>
<p>The Moon angular diameter varies between 29.3 to 34.1 arcminutes
(Wikipedia), namely 0.488 and 0.568 degree. The rise time is when the moon
is below the horizon at a negative angle half of these values, respectively
-0.244 and -0.284 degree</p>
<dl class="py method">
<dt class="sig sig-object py" id="visibility.Visibility.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos=&lt;SkyCoord</span> <span class="pre">(ICRS):</span> <span class="pre">(ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec)</span> <span class="pre">in</span> <span class="pre">deg</span>&#160;&#160;&#160;&#160; <span class="pre">(0.</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">0.)&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmin=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmax=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth=3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">status='Empty'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name='Dummy'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/visibility.html#Visibility.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#visibility.Visibility.__init__" title="Link to this definition"></a></dt>
<dd><p>Create a Visibility instance with default values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>pos</strong><span class="classifier">Astropy SkyCoord, optional</span></dt><dd><p>Source postion in the sky.
The default is SkyCoord(0*u.deg,0*u.deg, frame=’icrs’).</p>
</dd>
<dt><strong>site</strong><span class="classifier">string, optional</span></dt><dd><p>A keyword describing the site (e.g. <cite>North</cite>). The default is None.</p>
</dd>
<dt><strong>tmin</strong><span class="classifier">float, optional</span></dt><dd><p>The start of the observation after the explosion.
The default is minus infinity.</p>
</dd>
<dt><strong>tmax</strong><span class="classifier">float, optional</span></dt><dd><p>The end time of the observation after the explosion.
The default is infinity.</p>
</dd>
<dt><strong>depth: integer</strong></dt><dd><p>Maximal number of nights to be considered</p>
</dd>
<dt><strong>skip: integer</strong></dt><dd><p>Number of first nights to be skipped</p>
</dd>
<dt><strong>status</strong><span class="classifier">string, optional</span></dt><dd><p>A keyword cahracterising this visibility. The default is “Empty”.</p>
</dd>
<dt><strong>name</strong><span class="classifier">string, optional</span></dt><dd><p>A name for this visibility. The default is “Dummy”.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="visibility.Visibility.check">
<span class="sig-name descname"><span class="pre">check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">view</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_max=&lt;Quantity</span> <span class="pre">5.</span> <span class="pre">s&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/visibility.html#Visibility.check"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#visibility.Visibility.check" title="Link to this definition"></a></dt>
<dd><p>Check whether the visibility found is identical to the one in argument.</p>
<p>In particular, allow checking the default visibility for altmin=10°
and one night (The computation was done by maria Grazia Bernardini
(MGB). See README file for more information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>vis: Visibility</strong></dt><dd><p>The visibility to be compared wiht</p>
</dd>
<dt><strong>delta_max</strong><span class="classifier">float, optional</span></dt><dd><p>Max tolerance in seconds on window time limits.
The default is 5..</p>
</dd>
<dt><strong>log</strong><span class="classifier">file pointer, optional</span></dt><dd><p>Allows having the output both on screen and in a file. The default
is None.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="visibility.Visibility.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/visibility.html#Visibility.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#visibility.Visibility.compute" title="Link to this definition"></a></dt>
<dd><p>Compute visibility periods until the end of the last night.</p>
<p>Limit the computation to the data set times. This function takes as
arguments the parameters
required for the computation obtained from the <cite>visibility.yaml</cite> local
file through the <code class="xref py py-func docutils literal notranslate"><span class="pre">Configuration.decode_visibility_keyword()</span></code>
function.</p>
<p>The algorithm is the following:</p>
<ol class="arabic simple">
<li><dl class="simple">
<dt>Build periods for:</dt><dd><ul class="simple">
<li><p>Nights (<em>t_night</em>), and check if trigger occurs during night
(<em>is_night</em>);</p></li>
<li><p>Potential moon vetoes (<em>t_moon_alt_veto</em>) due to the Moon above
the defined horizon (<em>altmoon</em>);</p></li>
<li><p>Check (<em>True</em>, <em>False</em>) whether these Moon veto periods are kept
by the moon brightness and distance to the source
(<em>moonlight_veto</em>). If this is the case, keep the corresponding
moon veto period in <em>t_moon_veto</em> otherwise discard the period.
In order to have all Moon periods kept (i.e. veto is valid as
soon as Moon is above <em>altmoon</em>), <em>moondist</em> should be maximised
(veto at any distance) and <em>moonlight</em> should be minimised (even
if no moonligt, veto is valid);</p></li>
<li><p>Above horizon (<em>t_above</em>) and whether the object is above the
horizon (<em>altmin</em>) at trigger time.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Put all <em>start</em> and <em>stop</em> of all these periods in a list, sort the
list, resulting in a series of ordered “ticks”.</p></li>
<li><dl class="simple">
<dt>For each consecutive tick pairs in the list:</dt><dd><ul class="simple">
<li><p>Compute the mean time (middle of the a tick pair)</p></li>
<li><p>Check if that time belongs to one of the <em>night</em>, <em>above</em>, or
<em>bright</em> (i.e. in the available data interval) intervals and not
to any  <em>moon</em> interval. If so get True, otherwise False.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>For each of the tick pairs compute the Boolean <cite>visible = bright
and dark and above and moon</cite> and get the visibility windows when
True.</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>self</strong><span class="classifier">Visibility Object</span></dt><dd><p>The present instance.</p>
</dd>
<dt><strong>param</strong><span class="classifier">Dictionnary, optional</span></dt><dd><p>A dictionnary of parameters to compute the visibility.
The default is None.</p>
</dd>
<dt><strong>npt</strong><span class="classifier">integer, optional</span></dt><dd><p>Number of grid points for horizon crossing. The default is 150.</p>
</dd>
<dt><strong>debug</strong><span class="classifier">bool, optional</span></dt><dd><p>Print additional comments at excecution time if True .
The default is False.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Visibility Object</dt><dd><p>The updated instance.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="visibility.Visibility.def_vis_dicts">
<span class="sig-name descname"><span class="pre">def_vis_dicts</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'visibility.yaml'</span></em><a class="headerlink" href="#visibility.Visibility.def_vis_dicts" title="Link to this definition"></a></dt>
<dd><p>default visibility parameter file</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="visibility.Visibility.force_night">
<span class="sig-name descname"><span class="pre">force_night</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">altmin=&lt;Quantity</span> <span class="pre">24.</span> <span class="pre">deg&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth=3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npt=150</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/visibility.html#Visibility.force_night"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#visibility.Visibility.force_night" title="Link to this definition"></a></dt>
<dd><p>Compute the visibility assuming the night is of infinite length.</p>
<p>“Infinite” means from the trigger time to the end of the
data window with a safety margin of 1/10 of a day). Keep the vetoes
from the Moon and the altitude (above horizon).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>altmin</strong><span class="classifier">Qauntity degree, optional</span></dt><dd><p>Minimal altitude. The default is 24*u.deg.</p>
</dd>
<dt><strong>depth</strong><span class="classifier">integer, optional</span></dt><dd><p>The number of nights considered. The default is 3.</p>
</dd>
<dt><strong>npt</strong><span class="classifier">integer, optional</span></dt><dd><p><cite>astroplan</cite> number of search points. The default is 150.</p>
</dd>
<dt><strong>debug</strong><span class="classifier">boolean, optional</span></dt><dd><p>If True, display information. The default is False.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Visibility instance</dt><dd><p>Updated visibility instance.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="visibility.Visibility.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/visibility.html#Visibility.from_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#visibility.Visibility.from_dict" title="Link to this definition"></a></dt>
<dd><p>Read a Visibility instance from a dictionnary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>d</strong><span class="classifier">Dictionnary</span></dt><dd><p>Dictionnary with the Visibility parameters.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>inst</strong><span class="classifier">Visibility instance</span></dt><dd><p>Instance.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="visibility.Visibility.from_fits">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_fits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'None'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/visibility.html#Visibility.from_fits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#visibility.Visibility.from_fits" title="Link to this definition"></a></dt>
<dd><p>Get default visibility from input file.</p>
<ul class="simple">
<li><p>The start and stop dates are searched during 24h after the trigger
and correspond to the first visibility interval.</p></li>
<li><p>Does not report a second visibility interval during 24h, that
should be possible only if the target is promptly visible (about 15%
of the targets)</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>grb</strong><span class="classifier">GammaRayBurst instance</span></dt><dd><p>The current source.</p>
</dd>
<dt><strong>loc</strong><span class="classifier">string, optional</span></dt><dd><p>A string defining the site position. The default is “None”.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="visibility.Visibility.horizon">
<span class="sig-name descname"><span class="pre">horizon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/visibility.html#Visibility.horizon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#visibility.Visibility.horizon" title="Link to this definition"></a></dt>
<dd><p>Compute periods above horizon within the observation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>obs</strong><span class="classifier">Astroplan Observer instance</span></dt><dd><p>Current observation window.</p>
</dd>
<dt><strong>npt: integer</strong></dt><dd><p>Number of points for window searches (Astroplan).
The default is 150.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>t_above</strong><span class="classifier">List of Time intervals</span></dt><dd><p>List of periods above horizon.</p>
</dd>
<dt>high: Boolean</dt><dd><p>True if the observation starts above horizon.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="visibility.Visibility.ignore">
<span class="sig-name descname"><span class="pre">ignore</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#visibility.Visibility.ignore" title="Link to this definition"></a></dt>
<dd><p>Members to be ignored when exported to Json.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="visibility.Visibility.moon_alt_veto">
<span class="sig-name descname"><span class="pre">moon_alt_veto</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/visibility.html#Visibility.moon_alt_veto"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#visibility.Visibility.moon_alt_veto" title="Link to this definition"></a></dt>
<dd><p>Compute the Moon veto altitude.</p>
<p>First find windows where the Moon is too high.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>obs</strong><span class="classifier">Astroplan Observer instance</span></dt><dd><p>Current observation window.</p>
</dd>
<dt><strong>npt: integer</strong></dt><dd><p>Number of points for window searches (Astroplan).
The default is 150.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>tmoons</strong><span class="classifier">List of Time intervals</span></dt><dd><p>Periods where the Moon light is not affordable for the observation.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="visibility.Visibility.moon_halo">
<span class="sig-name descname"><span class="pre">moon_halo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/visibility.html#Visibility.moon_halo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#visibility.Visibility.moon_halo" title="Link to this definition"></a></dt>
<dd><p>Estimate moonlight halo intensity.</p>
<p>Returns the moon light intensity (hand-made model) as a function of
distance r. It is assumed that the intensity is constant (q0) along the
moon radius r0, and reach the fraction epsilon at the critical
distance rc, following a 1/r2 function 1/(a*(x-r0)**2 +c).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">float</span></dt><dd><p>Distance from the Moon.</p>
</dd>
<dt><strong>r0</strong><span class="classifier">float, optional</span></dt><dd><p>Moon radius. The default is 0.5.</p>
</dd>
<dt><strong>rc</strong><span class="classifier">float, optional</span></dt><dd><p>Moon halo critical radius. The default is 30.</p>
</dd>
<dt><strong>epsilon</strong><span class="classifier">float, optional</span></dt><dd><p>Affordable luminosity fraction. The default is 0.1.</p>
</dd>
<dt><strong>q0</strong><span class="classifier">float, optional</span></dt><dd><p>Moon light intensity (arbitrary unit). The default is 1.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>f</strong><span class="classifier">float</span></dt><dd><p>Moon halo intensity.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="visibility.Visibility.moon_halo_veto">
<span class="sig-name descname"><span class="pre">moon_halo_veto</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/visibility.html#Visibility.moon_halo_veto"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#visibility.Visibility.moon_halo_veto" title="Link to this definition"></a></dt>
<dd><p>Compute moonlight veto.</p>
<p>Returns the distance at which the moon intensity reaches the threshold
This is the analytical inverse of the moon_halo function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>q0</strong><span class="classifier">float, optional</span></dt><dd><p>Moon light intensity (arbitrary unit). The default is 1.</p>
</dd>
<dt><strong>threshold: float</strong></dt><dd><p>Affordable Moon light liminosity. The default is O.1.</p>
</dd>
<dt><strong>r0</strong><span class="classifier">float, optional</span></dt><dd><p>Moon radius. The default is 0.5.</p>
</dd>
<dt><strong>rc</strong><span class="classifier">float, optional</span></dt><dd><p>Moon halo critical radius. The default is 30.</p>
</dd>
<dt><strong>epsilon</strong><span class="classifier">float, optional</span></dt><dd><p>Affordable luminosity fraction. The default is 0.1.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>float</dt><dd><p>Radius with affordbale Moon light intensity.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="visibility.Visibility.moonlight_veto">
<span class="sig-name descname"><span class="pre">moonlight_veto</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/visibility.html#Visibility.moonlight_veto"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#visibility.Visibility.moonlight_veto" title="Link to this definition"></a></dt>
<dd><p>Compute moonlight vetoes.</p>
<p>Check if the Moon period defined by the rise and set time correspond
to a situation where the moon is too bright or too close from the
source.
If this is the case (too bright or too close), returns True
(the veto is confirmed).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>dt</strong><span class="classifier">Time interval</span></dt><dd><p>Current time interval.</p>
</dd>
<dt><strong>debug</strong><span class="classifier">Boolean, optional</span></dt><dd><p>If True, displays information. The default is False.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>too_bright</strong><span class="classifier">Boolean</span></dt><dd><p>True if Moon too bright.</p>
</dd>
<dt><strong>too_close</strong><span class="classifier">Boolean</span></dt><dd><p>True if Moon too close.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="visibility.Visibility.nights">
<span class="sig-name descname"><span class="pre">nights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/visibility.html#Visibility.nights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#visibility.Visibility.nights" title="Link to this definition"></a></dt>
<dd><p>Return night periods withinthe observation window.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>obs</strong><span class="classifier">Astroplan Observer instance</span></dt><dd><p>Current observation window.</p>
</dd>
<dt><strong>npt: integer</strong></dt><dd><p>Number of points for window searches (Astroplan).
The default is 150.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>tnights</strong><span class="classifier">List of Time intervals</span></dt><dd><p>List of nights.</p>
</dd>
<dt>is_night: Boolean</dt><dd><p>True if the observation starts at night.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="visibility.Visibility.object_to_serializable">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">object_to_serializable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/visibility.html#Visibility.object_to_serializable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#visibility.Visibility.object_to_serializable" title="Link to this definition"></a></dt>
<dd><p>Turn any non-standard object into a serializable type.</p>
<p>This is required for JSON to write it.
Note that this function explicitely returns a dictionnary.
Written by K. Kosack, September 2022</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="visibility.Visibility.params_from_key">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">params_from_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keyword</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/visibility.html#Visibility.params_from_key"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#visibility.Visibility.params_from_key" title="Link to this definition"></a></dt>
<dd><p>Get the parameters to compute the visibility.</p>
<p>Based on the existing dictionnaries.
Could be moved as a utility in the Configuration module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>keyword</strong><span class="classifier">string</span></dt><dd><p>One of the key in the dictionnary file.</p>
</dd>
<dt><strong>parfile</strong><span class="classifier">string, optional</span></dt><dd><p>The file name holding the dictionnaries. The default is
<cite>None</cite>.</p>
</dd>
<dt><strong>debug</strong><span class="classifier">boolean, optional</span></dt><dd><p>If True display information. The default is False.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Dictionnary</dt><dd><p>Parameters used to compute the visibility.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="visibility.Visibility.period_plot">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">period_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">twindow</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha=0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color='black'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color2='black'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag='?'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tshift=&lt;Quantity</span> <span class="pre">0.</span> <span class="pre">s&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/visibility.html#Visibility.period_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#visibility.Visibility.period_plot" title="Link to this definition"></a></dt>
<dd><p>Plot a specific period among.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>twindow</strong><span class="classifier">list of float</span></dt><dd><p>Time window boundaries.</p>
</dd>
<dt><strong>ax</strong><span class="classifier">matplolib axes, optional</span></dt><dd><p>Current axis. The default is None.</p>
</dd>
<dt><strong>alpha</strong><span class="classifier">float, optional</span></dt><dd><p>transparency. The default is 0.2.</p>
</dd>
<dt><strong>color</strong><span class="classifier">String, optional</span></dt><dd><p>Period start color. The default is “black”.</p>
</dd>
<dt><strong>color2</strong><span class="classifier">String, optional</span></dt><dd><p>Period end color. The default is “black”.</p>
</dd>
<dt><strong>tag</strong><span class="classifier">String, optional</span></dt><dd><p>Window tag. The default is “?”.</p>
</dd>
<dt><strong>tshift</strong><span class="classifier">sloat, optional</span></dt><dd><p>Time shift. The default is 0*u.s.</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier">aditionnal arguments</span></dt><dd><p>Additional axvspan arguments.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>ax</strong><span class="classifier">matplolib axes</span></dt><dd><p>Current axis.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="visibility.Visibility.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moon=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt_before=&lt;Quantity</span> <span class="pre">0.25</span> <span class="pre">d&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt_after=&lt;Quantity</span> <span class="pre">0.25</span> <span class="pre">d&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nalt=1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/visibility.html#Visibility.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#visibility.Visibility.plot" title="Link to this definition"></a></dt>
<dd><p>Plot all visibility ingredients on the same figure.</p>
<p>Plot the night, above-the-horizon and visibility periods, the altitude
evolution with time as well as a lightcurve for a fixed reference
energy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ax</strong><span class="classifier">An axis instance</span></dt><dd><p>Plots on this axis</p>
</dd>
<dt><strong>dt_before</strong><span class="classifier">astropy Quantity time, optional</span></dt><dd><p>Time period for plotting before the trigger.
The default is 0.25*u.day.</p>
</dd>
<dt><strong>dt_after</strong><span class="classifier">astropy Quantity time, optional</span></dt><dd><p>Time period for plotting after the trigger.
The default is 0.5*u.day.</p>
</dd>
<dt><strong>nalt</strong><span class="classifier">int, optional</span></dt><dd><p>Number of points to sample the altitude evolution with time.
The default is 25.</p>
</dd>
<dt><strong>inset</strong><span class="classifier">bool, optional</span></dt><dd><p>IfTrue, the figure will be plotted in an inset of the main plot.
They are simplified and the time is referred to the trigger time.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="visibility.Visibility.print">
<span class="sig-name descname"><span class="pre">print</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/visibility.html#Visibility.print"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#visibility.Visibility.print" title="Link to this definition"></a></dt>
<dd><p>Print out the GRB nights and default visibility window.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>log</strong><span class="classifier">TextIO, optional</span></dt><dd><p>Log file. The default is None.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="visibility.Visibility.summary">
<span class="sig-name descname"><span class="pre">summary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tref</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/visibility.html#Visibility.summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#visibility.Visibility.summary" title="Link to this definition"></a></dt>
<dd><p>Summarize visble/analyzable periods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>tref</strong><span class="classifier">Astropy Time Quantity</span></dt><dd><p>Reference time.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="visibility.Visibility.to_json">
<span class="sig-name descname"><span class="pre">to_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/visibility.html#Visibility.to_json"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#visibility.Visibility.to_json" title="Link to this definition"></a></dt>
<dd><p>Dump individual visibility instance to json.</p>
<p>This is here essentially for didactical purpose as it is preferred to
dump a dictionnary of visibilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>file</strong><span class="classifier">pointer to file, optional</span></dt><dd><p>Output file. The default is None.</p>
</dd>
<dt><strong>debug</strong><span class="classifier">boolean, optional</span></dt><dd><p>If True, say something. The default is False.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="visibility.Visibility.valid">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">valid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tslices</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/visibility.html#Visibility.valid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#visibility.Visibility.valid" title="Link to this definition"></a></dt>
<dd><p>Check it t0 in MJD is within the boundaries of tslices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t0</strong><span class="classifier">float</span></dt><dd><p>A time in days.</p>
</dd>
<dt><strong>tslices</strong><span class="classifier">list</span></dt><dd><p>A list of Astropy Time object pair.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>ok</strong><span class="classifier">boolean</span></dt><dd><p>return True if t0 within a slice.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="the-moon-module">
<h2>The <cite>moon</cite> module<a class="headerlink" href="#the-moon-module" title="Link to this heading"></a></h2>
</section>
<section id="module-moon">
<span id="moon-module"></span><h2>moon Module<a class="headerlink" href="#module-moon" title="Link to this heading"></a></h2>
<p>Created on Mon Oct 17 14:47:57 2022</p>
<p>&#64;author: Stolar</p>
<section id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Link to this heading"></a></h3>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="api/moon.moonphase_plot.html#moon.moonphase_plot" title="moon.moonphase_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">moonphase_plot</span></code></a>(times[, ax, color])</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/moon.moon_alt_plot.html#moon.moon_alt_plot" title="moon.moon_alt_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">moon_alt_plot</span></code></a>(times, alt[, ax, alpha, color])</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/moon.moonlight_plot.html#moon.moonlight_plot" title="moon.moonlight_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">moonlight_plot</span></code></a>(times[, ax, color, norm, tag])</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/moon.moon_dist_plot.html#moon.moon_dist_plot" title="moon.moon_dist_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">moon_dist_plot</span></code></a>(radec, times, moon_radec[, ...])</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="the-observatory-module">
<h2>The <cite>observatory</cite> module<a class="headerlink" href="#the-observatory-module" title="Link to this heading"></a></h2>
</section>
<section id="module-observatory">
<span id="observatory-module"></span><h2>observatory Module<a class="headerlink" href="#module-observatory" title="Link to this heading"></a></h2>
<p>Created on Fri Sep 16 10:26:34 2022</p>
<p>This module contains information on various observatory locations.</p>
<p>&#64;author: Stolar</p>
<section id="variables">
<h3>Variables<a class="headerlink" href="#variables" title="Link to this heading"></a></h3>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="api/observatory.xyz.html#observatory.xyz" title="observatory.xyz"><code class="xref py py-obj docutils literal notranslate"><span class="pre">xyz</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Th. Stolarczyk.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>