

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Configuration file &mdash; SoHAPPy 0.9 beta documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=88ef157a"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            SoHAPPy
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Configuration file</a><ul>
<li><a class="reference internal" href="#physics-parameters">Physics parameters</a></li>
<li><a class="reference internal" href="#input-output-file-names-and-directories">Input / Output file names and directories</a></li>
<li><a class="reference internal" href="#simulation-parameters">Simulation parameters</a></li>
<li><a class="reference internal" href="#detection-parameters">Detection parameters</a></li>
<li><a class="reference internal" href="#debugging-and-bookkeeping">Debugging and bookkeeping</a></li>
<li><a class="reference internal" href="#experts-and-developpers-only">Experts and developpers only</a></li>
<li><a class="reference internal" href="#module-configuration">configuration Module</a><ul>
<li><a class="reference internal" href="#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SoHAPPy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Configuration file</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/configuration.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="configuration-file">
<h1>Configuration file<a class="headerlink" href="#configuration-file" title="Link to this heading"></a></h1>
<p>A simulation and analysis parameter file can be passed to the main script with
the <cite>-c</cite> options (some of these parameters can be superseded on the command
line, use  <cite>-h</cite> to get the list). If no file name is given, the parameters
are read from the <em>data/config_ref.yaml</em> default file provided with the code
sources.</p>
<p>The base input and output folders are defined through the <cite>HAPPY_IN</cite> and
<cite>HAPPY_OUT</cite> environment variables respectively.</p>
<p>The execution of <cite>SoHAPPy</cite> automatically creates a copy (backup) of the chosen
configuration file to the output folder, with the initial parameters
overwritten by the ones on the command line, so that this backuped
configuration can be used to reprocess the data in the exact same conditions.</p>
<p>The configuration data are stored and processed in the
<a class="reference internal" href="api/configuration.Configuration.html#configuration.Configuration" title="configuration.Configuration"><code class="xref py py-class docutils literal notranslate"><span class="pre">configuration.Configuration</span></code></a> class in <code class="file docutils literal notranslate"><span class="pre">configuration.py</span></code>.</p>
<p>The following parameters are defined and mandatory in the configuration file.
Extra parameters can be added and are notified as ignored at run time. The
defauilt in the following tables are the one in the <em>data/config_ref.yaml</em>
file.</p>
<section id="physics-parameters">
<h2>Physics parameters<a class="headerlink" href="#physics-parameters" title="Link to this heading"></a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>variable</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>What is it ?</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ifirst</span></code></p></td>
<td><p>1</p></td>
<td><div class="line-block">
<div class="line">The first GRB identifier to be processed</div>
<div class="line">or a list of identifiers or a json file with</div>
<div class="line">paths to files to be processed.</div>
<div class="line">The identifiers can include a string referring</div>
<div class="line">to a <cite>yaml</cite> file with parameters to generate</div>
<div class="line">spectra from an analytical function.</div>
<div class="line">(See the <cite>data/historical</cite> folder)</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">nsrc</span></code></p></td>
<td><p>1</p></td>
<td><div class="line-block">
<div class="line">Number of GRB to be processed if <code class="docutils literal notranslate"><span class="pre">ifirst</span></code> is</div>
<div class="line">an integer. If 1, special actions are taken.</div>
<div class="line">Not used if <code class="docutils literal notranslate"><span class="pre">ifirst</span></code> is a list.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">visibility</span></code></p></td>
<td><p>“strictmoonveto”</p></td>
<td><div class="line-block">
<div class="line">Can be:</div>
<div class="line">* <cite>built-in</cite> (read from the data file if it</div>
<div class="line">exists),</div>
<div class="line">* a keyword pointing to a folder containing</div>
<div class="line"><cite>json</cite> files with a collection of visibilities;</div>
<div class="line">* a keyword corresponding to a dictionnay entry</div>
<div class="line">in <cite>visibility.yaml</cite> to compute the visibility</div>
<div class="line">on the fly (example given)</div>
<div class="line">* <cite>forced</cite> to force a single infinite night</div>
<div class="line">* <cite>permanent</cite> to force a permanent visibility</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ebl_model</span></code></p></td>
<td><p>“dominguez”</p></td>
<td><div class="line-block">
<div class="line">Extragalactic Background Light model as</div>
<div class="line">defined in <code class="docutils literal notranslate"><span class="pre">gammapy</span></code> or <cite>built-in</cite> if</div>
<div class="line">provided or <cite>None</cite> if ignored (no absortpion)</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">maxnight</span></code></p></td>
<td><p>Null</p></td>
<td><p>Limit data to a maximal number of nights</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">skip</span></code></p></td>
<td><p>Null</p></td>
<td><p>Skip the first nights</p></td>
</tr>
</tbody>
</table>
</section>
<section id="input-output-file-names-and-directories">
<h2>Input / Output file names and directories<a class="headerlink" href="#input-output-file-names-and-directories" title="Link to this heading"></a></h2>
<p>See file for examples.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>variable</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>What is it ?</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">out_dir</span></code></p></td>
<td><p>None</p></td>
<td><div class="line-block">
<div class="line">Specific output subfolder, with a name</div>
<div class="line">related to tests or IRF</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">data_dir</span></code></p></td>
<td><p>None</p></td>
<td><p>Data subfolder</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">prompt_dir</span></code></p></td>
<td><p>None</p></td>
<td><div class="line-block">
<div class="line">if not Null, read time-integrated</div>
<div class="line">prompt from this subfolder</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">irf_dir</span></code></p></td>
<td><p>None</p></td>
<td><div class="line-block">
<div class="line">IRF subfolder - should contain a tag</div>
<div class="line">for the production used</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">prefix</span></code></p></td>
<td><p>“<a href="#id1"><span class="problematic" id="id2">event_</span></a>”</p></td>
<td><div class="line-block">
<div class="line">The prefix before the source identifier</div>
<div class="line">to create the full file name</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">suffix</span></code></p></td>
<td><p>“long_ISM.fits”</p></td>
<td><div class="line-block">
<div class="line">The suffix after the source identifier to</div>
<div class="line">create the file name (including the extension)</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dgt</span></code></p></td>
<td><p>5</p></td>
<td><div class="line-block">
<div class="line">Number of digit on which the integer refereing</div>
<div class="line">to anidentifier is encoded (e.g. 00001 for 1)</div>
</div>
</td>
</tr>
</tbody>
</table>
</section>
<section id="simulation-parameters">
<h2>Simulation parameters<a class="headerlink" href="#simulation-parameters" title="Link to this heading"></a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>variable</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>What is it ?</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">niter</span></code></p></td>
<td><p>1</p></td>
<td><p>Number of Monte Carlo trials</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">seed</span></code></p></td>
<td><p>2021</p></td>
<td><p>Choose ‘random-seed’ to randomize</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">do_fluctuate</span></code></p></td>
<td><p>False</p></td>
<td><p>Statistical fluctuations are enabled</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">do_accelerate</span></code></p></td>
<td><p>True</p></td>
<td><div class="line-block">
<div class="line">When True, the simulation is stopped if</div>
<div class="line">none of the first trials in the limit</div>
<div class="line">of <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">-</span> <span class="pre">det_level</span></code> have reached the minimal</div>
<div class="line">significance. In a simulation with 100</div>
<div class="line">trials requesting a 3 sigma detection in</div>
<div class="line">90% of the iterations, the simulation will</div>
<div class="line">be stopped after 10 iterations*</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>(*) Note that this bias the resulting population since it artificially depletes
the maximal significance population below the minimum required (e.g. 3 sigma).</p>
</section>
<section id="detection-parameters">
<h2>Detection parameters<a class="headerlink" href="#detection-parameters" title="Link to this heading"></a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>variable</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>What is it ?</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">observatory</span></code></p></td>
<td><p>“CTAO”</p></td>
<td><p>Observatory name (for position on Earth)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">array_North</span></code></p></td>
<td><p>“4LSTs09MSTs”</p></td>
<td><p>IRF North array, subfolder name</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">array_South</span></code></p></td>
<td><p>“14MSTs37SSTs”</p></td>
<td><p>IRF South array, subfolder name</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dtslew_North</span></code></p></td>
<td><p>“30 s”</p></td>
<td><p>Maximum slewing time delay in North</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dtslew_South</span></code></p></td>
<td><p>“90 s”</p></td>
<td><p>Maximum slewing time delay in South</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">fixslew</span></code></p></td>
<td><p>True</p></td>
<td><dl class="simple">
<dt>If False generate a random delay less</dt><dd><p>than <code class="docutils literal notranslate"><span class="pre">dtslew</span></code>. If True use <code class="docutils literal notranslate"><span class="pre">dtswift</span></code></p>
</dd>
</dl>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dtswift</span></code></p></td>
<td><p>“77 s”</p></td>
<td><div class="line-block">
<div class="line">Alert latency Fixed SWIFT latency</div>
<div class="line">(e.g. SWIFT latency, with</div>
<div class="line">a mean value of 77 s)</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">fixswift</span></code></p></td>
<td><p>True</p></td>
<td><div class="line-block">
<div class="line">If False, the latency is generated from</div>
<div class="line">real data file (see below)</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">swiftfile</span></code></p></td>
<td><div class="line-block">
<div class="line">data/swift/</div>
<div class="line">Swift_delay_times.txt</div>
</div>
</td>
<td><p>Swift latency file</p></td>
</tr>
</tbody>
</table>
</section>
<section id="debugging-and-bookkeeping">
<h2>Debugging and bookkeeping<a class="headerlink" href="#debugging-and-bookkeeping" title="Link to this heading"></a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>variable</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>What is it ?</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dbg</span></code></p></td>
<td><p>0</p></td>
<td><p>From 0 to 3, increasingly talkative</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">silent</span></code></p></td>
<td><p>False</p></td>
<td><p>If True, nothing on screen (output to log)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">save_simu</span></code></p></td>
<td><p>False</p></td>
<td><p>Simulation saved to file for offline use</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">save_grb</span></code></p></td>
<td><p>False</p></td>
<td><p>GRB class saved to disk -&gt; use grb.py main</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">save_fig</span></code></p></td>
<td><p>False</p></td>
<td><p>Figures saved to disk</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">datafile</span></code></p></td>
<td><p>“data.txt”</p></td>
<td><p>Population study main output file</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">logfile</span></code></p></td>
<td><p>“analysis.log”</p></td>
<td><p>Text file with results, status and warning</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">remove_tar</span></code></p></td>
<td><p>False</p></td>
<td><div class="line-block">
<div class="line">Remove tarred files, otherwise keep for</div>
<div class="line">faster access</div>
</div>
</td>
</tr>
</tbody>
</table>
</section>
<section id="experts-and-developpers-only">
<h2>Experts and developpers only<a class="headerlink" href="#experts-and-developpers-only" title="Link to this heading"></a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>variable</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>What is it ?</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">det_level</span></code></p></td>
<td><p>0.9</p></td>
<td><p>Confidence level for detection</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">alpha</span></code></p></td>
<td><p>0.2</p></td>
<td><p>One over the number of on/off regions</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">elimit</span></code></p></td>
<td><p>Null</p></td>
<td><p>Limit energy bins for CPU saving (Quantity)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">tlimit</span></code></p></td>
<td><p>Null</p></td>
<td><p>Limit time bins for CPU saving (Quantity)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">emin</span></code></p></td>
<td><p>Null</p></td>
<td><p>Analysis Energy lower limit (Quantity)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">emax</span></code></p></td>
<td><p>Null</p></td>
<td><p>Analysis Energy upper limit (Quantity)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">e_dense</span></code></p></td>
<td><p>Null</p></td>
<td><p>Use a denser E-binning for spectral analysis</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">tmin</span></code></p></td>
<td><p>Null</p></td>
<td><p>Analysis time lower limit (Quantity)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">tmax</span></code></p></td>
<td><p>Null</p></td>
<td><p>Analysis time  upper limit (Quantity)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">obs_point</span></code></p></td>
<td><p>“end”</p></td>
<td><p>Observation position in the time slice</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">test_prompt</span></code></p></td>
<td><p>False</p></td>
<td><p>If True test prompt alone (experimental)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">use_afterglow</span></code></p></td>
<td><p>False</p></td>
<td><div class="line-block">
<div class="line">Prompt characteritics from the afterglow</div>
<div class="line">with same id.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">tshift</span></code></p></td>
<td><p>0</p></td>
<td><p>Shift in days applied to all trigger dates</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">fixed_zenith</span></code></p></td>
<td><p>None</p></td>
<td><p>If a value (<cite>20*u.deg</cite>) freeze zenith in IRF</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">magnify</span></code></p></td>
<td><p>1</p></td>
<td><p>Multiplicative factor of the flux, for tests</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">write_slices</span></code></p></td>
<td><p>False</p></td>
<td><p>Store detailed information on slices if True</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">save_dataset</span></code></p></td>
<td><p>False</p></td>
<td><p>Not implemented (save datasets)</p></td>
</tr>
</tbody>
</table>
</section>
<section id="module-configuration">
<span id="configuration-module"></span><h2>configuration Module<a class="headerlink" href="#module-configuration" title="Link to this heading"></a></h2>
<p>Created on Tue Aug  4 13:17:27 2020.</p>
<p>This module is organised around the <a class="reference internal" href="api/configuration.Configuration.html#configuration.Configuration" title="configuration.Configuration"><code class="xref py py-class docutils literal notranslate"><span class="pre">Configuration</span></code></a> class.</p>
<p>&#64;author: Stolar</p>
<section id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Link to this heading"></a></h3>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="api/configuration.Configuration.html#configuration.Configuration" title="configuration.Configuration"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Configuration</span></code></a>()</p></td>
<td><p>SoHAPPy steering parameters and input/output.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Th. Stolarczyk.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>