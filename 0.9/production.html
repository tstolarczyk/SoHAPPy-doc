<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Running large simulations and analysis &mdash; SoHAPPy 0.9 beta documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="slurm_cmd" href="api/generator.slurm_cmd.html" />
    <link rel="prev" title="Input file format" href="file_format.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> SoHAPPy
          </a>
              <div class="version">
                0.9
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">How to run it</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="sohappy.html">How it works ?</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration file</a></li>
<li class="toctree-l1"><a class="reference internal" href="irf.html">Instrument response functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="file_format.html">Input file format</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Running large simulations and analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#generating-visibilities">Generating visibilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#generating-dates-positions-and-visibilities-ex-nihilio">Generating dates, positions and visibilities ex-nihilio</a></li>
<li class="toctree-l3"><a class="reference internal" href="#files-with-dates-and-positions-already-known">Files with dates and positions already known</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-skygen-module">The <cite>skygen</cite> module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#preparing-batch-submissions">Preparing batch submissions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-generator-module">The <cite>generator</cite>  module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-generator">generator Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#functions">Functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beginning-to-end-example">Beginning-to-end example</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#interactive-test">Interactive test</a></li>
<li class="toctree-l3"><a class="reference internal" href="#batch-test">Batch test</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Concepts and classes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="grb.html">Astrophysical objects (GRB)</a></li>
<li class="toctree-l1"><a class="reference internal" href="time_slice.html">Time slices and slots</a></li>
<li class="toctree-l1"><a class="reference internal" href="visibility.html">Visibilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="simulation.html">Simulation and Analysis</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Analyzing the output files</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="population_analysis.html">Population analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="spectral_analysis.html">Spectral analysis of an astrophysical source</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tools.html">Tools</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">The developer corner</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="developer.html">Building the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer.html#todo-list">Todo list</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SoHAPPy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">Running large simulations and analysis</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/production.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="running-large-simulations-and-analysis">
<h1>Running large simulations and analysis<a class="headerlink" href="#running-large-simulations-and-analysis" title="Permalink to this heading"></a></h1>
<p>A production starts from a set of files with a collection of energy spectra
for a series of time slices, plus some physical information from the sources
(redshift, trigger time, sky position). The data are usually stored as <cite>fits</cite>
file with a specific format but other formats are possible (like <cite>yaml</cite> files
to reproduce simplistic lighcurves with two time and energy indices).</p>
<p>This page:</p>
<ul class="simple">
<li><p>describes how to generate sky positions and/or trigger times, and
visibilities in files independent of the source file information in a way
which is manageable by <cite>SoHAPPy</cite>,</p></li>
<li><p>explains how to generate command lines and scripts usable for batch submisions;</p></li>
<li><p>shows examples on how to launch batch jobs.</p></li>
</ul>
<section id="generating-visibilities">
<h2>Generating visibilities<a class="headerlink" href="#generating-visibilities" title="Permalink to this heading"></a></h2>
<p>The module <code class="xref py py-obj docutils literal notranslate"><span class="pre">skygen.py</span></code> generates trigger times, sky positions and the
related visibilities from command line arguments. It is able to generate several
output files for a sequence of subsets of a given population. This subsets are
useful to launch <cite>SoHAPPy</cite> on a batch system (see <a class="reference internal" href="#batch-submission">batch submission</a>).
The command line arguments are obtained from:</p>
<p><code class="code docutils literal notranslate"><span class="pre">python</span> <span class="pre">skygen.py</span> <span class="pre">-h</span></code></p>
<p>and the output is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">skygen</span><span class="o">.</span><span class="n">py</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">y</span> <span class="n">YEAR1</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">n</span> <span class="n">NYEARS</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">f</span> <span class="n">FIRST</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">N</span> <span class="n">NSRC</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">v</span> <span class="n">VERSION</span><span class="p">]</span>
                 <span class="p">[</span><span class="o">-</span><span class="n">D</span> <span class="n">DAYS</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">V</span> <span class="n">VISIBILITY</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">c</span> <span class="n">CONFIG</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">o</span> <span class="n">OUTPUT</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">s</span> <span class="n">SEED</span><span class="p">]</span>
                 <span class="p">[</span><span class="o">--</span><span class="n">debug</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">nodebug</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">trigger</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">notrigger</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">position</span><span class="p">]</span>
                 <span class="p">[</span><span class="o">--</span><span class="n">noposition</span><span class="p">]</span>

<span class="n">Generate</span> <span class="n">visibilities</span> <span class="k">for</span> <span class="n">SoHAPPy</span>

<span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>            <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>
  <span class="o">-</span><span class="n">y</span> <span class="n">YEAR1</span><span class="p">,</span> <span class="o">--</span><span class="n">year1</span> <span class="n">YEAR1</span>
                        <span class="n">First</span> <span class="n">year</span>
  <span class="o">-</span><span class="n">n</span> <span class="n">NYEARS</span><span class="p">,</span> <span class="o">--</span><span class="n">nyears</span> <span class="n">NYEARS</span>
                        <span class="n">Number</span> <span class="n">of</span> <span class="n">years</span>
  <span class="o">-</span><span class="n">f</span> <span class="n">FIRST</span><span class="p">,</span> <span class="o">--</span><span class="n">first</span> <span class="n">FIRST</span>
                        <span class="n">First</span> <span class="n">source</span> <span class="n">identifier</span>
  <span class="o">-</span><span class="n">N</span> <span class="n">NSRC</span><span class="p">,</span> <span class="o">--</span><span class="n">Nsrc</span> <span class="n">NSRC</span>  <span class="n">Number</span> <span class="n">of</span> <span class="n">sources</span>
  <span class="o">-</span><span class="n">v</span> <span class="n">VERSION</span><span class="p">,</span> <span class="o">--</span><span class="n">version</span> <span class="n">VERSION</span>
                        <span class="n">version</span> <span class="n">number</span>
  <span class="o">-</span><span class="n">D</span> <span class="n">DAYS</span><span class="p">,</span> <span class="o">--</span><span class="n">days</span> <span class="n">DAYS</span>  <span class="n">Visibility</span> <span class="nb">range</span> <span class="ow">in</span> <span class="n">days</span>
  <span class="o">-</span><span class="n">V</span> <span class="n">VISIBILITY</span><span class="p">,</span> <span class="o">--</span><span class="n">visibility</span> <span class="n">VISIBILITY</span>
                        <span class="n">Visibility</span> <span class="n">keywords</span>
  <span class="o">-</span><span class="n">c</span> <span class="n">CONFIG</span><span class="p">,</span> <span class="o">--</span><span class="n">config</span> <span class="n">CONFIG</span>
                        <span class="n">Configuration</span> <span class="n">file</span> <span class="n">name</span>
  <span class="o">-</span><span class="n">o</span> <span class="n">OUTPUT</span><span class="p">,</span> <span class="o">--</span><span class="n">output</span> <span class="n">OUTPUT</span>
                        <span class="n">Output</span> <span class="n">base</span> <span class="n">folder</span> <span class="p">(</span><span class="n">path</span><span class="p">)</span>
  <span class="o">-</span><span class="n">s</span> <span class="n">SEED</span><span class="p">,</span> <span class="o">--</span><span class="n">seed</span> <span class="n">SEED</span>  <span class="n">Seed</span> <span class="kn">from</span> <span class="nn">random</span> <span class="n">generator</span>
  <span class="o">--</span><span class="n">debug</span>               <span class="n">Display</span> <span class="n">processing</span> <span class="n">details</span>
  <span class="o">--</span><span class="n">nodebug</span>             <span class="n">Does</span> <span class="ow">not</span> <span class="n">display</span> <span class="n">processing</span> <span class="n">details</span>
  <span class="o">--</span><span class="n">trigger</span>             <span class="p">(</span><span class="n">re</span><span class="p">)</span><span class="n">generate</span> <span class="n">dates</span>
  <span class="o">--</span><span class="n">notrigger</span>           <span class="n">Do</span> <span class="ow">not</span> <span class="n">generate</span> <span class="n">dates</span> <span class="k">if</span> <span class="n">already</span> <span class="n">existing</span>
  <span class="o">--</span><span class="n">position</span>            <span class="n">Generate</span> <span class="n">new</span> <span class="n">positions</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">sky</span>
  <span class="o">--</span><span class="n">noposition</span>          <span class="n">Do</span> <span class="ow">not</span> <span class="n">generate</span> <span class="n">new</span> <span class="n">sky</span> <span class="n">positions</span> <span class="k">if</span> <span class="n">already</span> <span class="n">existing</span>

<span class="o">---</span>
</pre></div>
</div>
<section id="generating-dates-positions-and-visibilities-ex-nihilio">
<h3>Generating dates, positions and visibilities ex-nihilio<a class="headerlink" href="#generating-dates-positions-and-visibilities-ex-nihilio" title="Permalink to this heading"></a></h3>
<p>Let’s create dates, positions and visibilities for ten sources, starting
from source number 1, with dates randomly chosen between 2004
(January 1 <sup>st</sup>, 0h00’00) and end of 2013
(December 31 <sup>st</sup>, just before midnight,i.e. <cite>23h59’59</cite>):</p>
<p><code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">skygen.py</span>&#160; <span class="pre">-y</span> <span class="pre">2004</span> <span class="pre">-n</span> <span class="pre">10</span> <span class="pre">-f</span> <span class="pre">1</span> <span class="pre">-N</span> <span class="pre">7</span></code></p>
<p>The resulting files are in the folder:
<code class="docutils literal notranslate"><span class="pre">skygen_vis/long_1_1000/test_omega</span></code> <strong>strictmoonveto_2004_10_v1</strong></p>
<p>In order to be used by SoHAPPy, the <cite>skygen_vis</cite> subfolder has to be moved to
<code class="docutils literal notranslate"><span class="pre">HAPPY_OUT</span></code> folder where it will be found by <cite>SoHAPPy</cite> later.</p>
<p>It is intended to be used with a population having trigger dates along ten
years, starting in 2004. The last number indicates a version number (in case
other dates and positions would be randomly generated with the same
constraints). It can be changed with the <cite>-v</cite> option.</p>
<p>The file in the folder have the source indices in its name, from 1 to 7 :</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">DP_strictmoonveto_2004_10_v1_1_7.yaml</span></code> for the dates and positions.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">strictmoonveto_2004_10_v1_1_7.json</span></code> for the visibilities.</p></li>
</ul>
</div></blockquote>
<p>Naturally, the next files in the series can be produced, e.g.
<code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">skygen.py</span>&#160; <span class="pre">-y</span> <span class="pre">2004</span> <span class="pre">-N</span> <span class="pre">10</span> <span class="pre">-f</span> <span class="pre">8</span> <span class="pre">-N</span> <span class="pre">5</span></code></p>
<p>The code output is the following:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span>--------------------------------------------------
 Generation number (version):  1
 Source identifiers from  8  to  12  ( 5 )
 Generated dates
  - from               :  2004
  - to                 :  2013
  - Duration (yr)      :  10
 Visibility:
  - Visibility keyword :  strictmoonveto
  -            range   :  3.0 d
  - Output folder      :  skygen_vis
 Debugging :  False

Command line:
skygen.py --year1 2004 --nyears 10 --first 8 --Nsrc 5 --version 1 --days 3.0 d --visibility strictmoonveto --output skygen_vis --seed 2022 --nodebug --notrigger --noposition
--------------------------------------------------
log information to file skygen.log
+------------------------------------------------------------------------------+
+                          Dates and positon - random                          +
+------------------------------------------------------------------------------+

+------------------------------------------------------------------------------+
+                             Create output folder                             +
+------------------------------------------------------------------------------+

skygen_vis\strictmoonveto_2004_10_v1\ Already exists
+------------------------------------------------------------------------------+
+                     Dumping generated dates and posiiton                     +
+------------------------------------------------------------------------------+

 Output: skygen_vis\strictmoonveto_2004_10_v1\DP_strictmoonveto_2004_10_1_8_12.yaml
Done!
+------------------------------------------------------------------------------+
+                            Creating visibilities                             +
+------------------------------------------------------------------------------+

# 8  # 9  # 10  # 11  # 12   - Done
+------------------------------------------------------------------------------+
+                        Dumping generated visibilities                        +
+------------------------------------------------------------------------------+

Output: skygen_vis\strictmoonveto_2004_10_v1\strictmoonveto_2004_10_v1_8_12.json

-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*
 Duration      =    13.90 (s)
  per source   =     2.78 (s)
 ******* End of job - Total time =     0.23 min *****

2023-08-08 16:27:04.568052
</pre></div>
</div>
</div></blockquote>
<p>And, as an example, the date-position file,
<cite>DP_strictmoonveto_2004_10_v1_8_12.yaml</cite>, in the same folder as the previous one,
has the following content:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">created</span><span class="p">:</span> <span class="mi">2023</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">08</span> <span class="mi">16</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span><span class="mf">50.677299</span>
<span class="n">id1</span><span class="p">:</span> <span class="mi">8</span>
<span class="n">nsrc</span><span class="p">:</span> <span class="mi">5</span>
<span class="n">seed</span><span class="p">:</span> <span class="mi">2022</span>
<span class="n">start</span><span class="p">:</span> <span class="mi">2004</span>
<span class="n">stop</span><span class="p">:</span> <span class="mi">2013</span>
<span class="n">config</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">basedir</span><span class="p">:</span> <span class="n">skygen_vis</span>
<span class="n">key</span><span class="p">:</span> <span class="n">strictmoonveto</span>
<span class="n">duration</span><span class="p">:</span> <span class="mf">3.0</span> <span class="n">d</span>
<span class="n">version</span><span class="p">:</span> <span class="mi">1</span>
<span class="n">ev8</span><span class="p">:</span>     <span class="mf">56041.9340364733</span>             <span class="mf">3.369101</span>            <span class="o">-</span><span class="mf">1.491226</span> <span class="c1"># 2012-04-24T22:25:00.751</span>
<span class="n">ev9</span><span class="p">:</span>     <span class="mf">56028.1061458277</span>           <span class="mf">179.660812</span>            <span class="mf">52.684967</span> <span class="c1"># 2012-04-11T02:32:51.000</span>
<span class="n">ev10</span><span class="p">:</span>     <span class="mf">56050.0662109165</span>            <span class="mf">40.818128</span>            <span class="mf">17.151789</span> <span class="c1"># 2012-05-03T01:35:20.623</span>
<span class="n">ev11</span><span class="p">:</span>     <span class="mf">56501.0829470993</span>            <span class="mf">17.990647</span>            <span class="mf">52.553954</span> <span class="c1"># 2013-07-28T01:59:26.629</span>
<span class="n">ev12</span><span class="p">:</span>     <span class="mf">54349.4663241195</span>           <span class="mf">246.746734</span>            <span class="mf">26.248797</span> <span class="c1"># 2007-09-06T11:11:30.404</span>
</pre></div>
</div>
<p>To get the files with other visibility conditions, pass the correct keyword to
the command line :</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">skygen.py</span>&#160; <span class="pre">-y</span> <span class="pre">2004</span> <span class="pre">-n</span> <span class="pre">10</span> <span class="pre">-f</span> <span class="pre">1</span> <span class="pre">-N</span> <span class="pre">7</span> <span class="pre">-V</span> <span class="pre">nomoonveto</span></code></p>
</div></blockquote>
<p>This will create the two files :
<code class="docutils literal notranslate"><span class="pre">skygen_vis/long_1_1000/test_omega/nomoonveto_2004_10_v1/DP_nomoonveto_2004_10_1_8_12.yaml</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">skygen_vis/long_1_1000/test_omega/nomoonveto_2004_10_v1/nomoonveto_2004_10_1_8_12.json</span></code></p>
</section>
<section id="files-with-dates-and-positions-already-known">
<h3>Files with dates and positions already known<a class="headerlink" href="#files-with-dates-and-positions-already-known" title="Permalink to this heading"></a></h3>
<p>In some cases, the source files have already trigger times and postions given
(and even sometimes a default visibility encoded). This is the case of the
first 1000 long afterglows primarliy studied with <cite>SoHAPPy</cite>.</p>
<p>The access to this information is done through the <cite>config.yaml</cite> file where
the file position will be read. Here is an example:</p>
<p><code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">skygen.py</span> <span class="pre">-f</span> <span class="pre">1</span> <span class="pre">-N</span> <span class="pre">7</span> <span class="pre">-c</span> <span class="pre">data/config_ref.yaml</span> <span class="pre">-v</span> <span class="pre">&quot;default&quot;</span></code></p>
<p>In this strict case, the dates and positions will not be recomputed since they
already exist (even if a start year and a number of years would be given).
<cite>skygen</cite> will generate the visibility for the default <cite>strictmoonveto</cite>
conditions. It correspond to the explicit command line:</p>
<p><code class="docutils literal notranslate"><span class="pre">skygen.py</span> <span class="pre">--year1</span> <span class="pre">9999</span> <span class="pre">--nyears</span> <span class="pre">1</span> <span class="pre">--first</span> <span class="pre">1</span> <span class="pre">--Nsrc</span> <span class="pre">7</span> <span class="pre">--version</span> <span class="pre">default</span> <span class="pre">--days</span> <span class="pre">3.0</span> <span class="pre">d</span> <span class="pre">--visibility</span> <span class="pre">strictmoonveto</span> <span class="pre">--config</span> <span class="pre">data/config_ref.yaml</span> <span class="pre">--output</span> <span class="pre">skygen_vis</span> <span class="pre">--seed</span> <span class="pre">2022</span> <span class="pre">--nodebug</span> <span class="pre">--notrigger</span> <span class="pre">--noposition</span></code></p>
<p>The <cite>DP</cite> file contain the original information contained in the source file.
The visibility file contains the computed visibility.</p>
<p>More interesting is the case where it is requested to generate the trigger dates
(and not the source posiition) for a series of sources:</p>
<p><code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">skygen.py</span> <span class="pre">-y</span> <span class="pre">2000</span> <span class="pre">-n</span> <span class="pre">44</span> <span class="pre">-f</span> <span class="pre">1</span> <span class="pre">-N</span> <span class="pre">7</span> <span class="pre">-c</span> <span class="pre">data/config_ref.yaml</span> <span class="pre">-v</span> <span class="pre">&quot;triggers&quot;</span></code></p>
<p>For illustration, the start of the returned message is the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--------------------------------------------------</span>
 <span class="n">Generation</span> <span class="n">number</span> <span class="p">(</span><span class="n">version</span><span class="p">):</span>  <span class="n">triggers</span>
 <span class="n">Source</span> <span class="n">identifiers</span> <span class="kn">from</span>  <span class="mi">1</span>  <span class="n">to</span>  <span class="mi">7</span>  <span class="p">(</span> <span class="mi">7</span> <span class="p">)</span>
 <span class="n">Generated</span> <span class="n">dates</span>
  <span class="o">-</span> <span class="kn">from</span>               <span class="p">:</span>  <span class="mi">2000</span>
  <span class="o">-</span> <span class="n">to</span>                 <span class="p">:</span>  <span class="mi">2043</span>
  <span class="o">-</span> <span class="n">Duration</span> <span class="p">(</span><span class="n">yr</span><span class="p">)</span>      <span class="p">:</span>  <span class="mi">44</span>
 <span class="n">Reading</span> <span class="n">dates</span> <span class="ow">and</span> <span class="n">positions</span> <span class="kn">from</span> <span class="nn">source</span> <span class="n">files</span>
  <span class="o">-</span> <span class="n">Configuration</span> <span class="n">file</span>  <span class="p">:</span>  <span class="n">data</span>\<span class="n">config_ref</span><span class="o">.</span><span class="n">yaml</span>
  <span class="o">-</span> <span class="n">New</span> <span class="n">dates</span>           <span class="p">:</span>  <span class="kc">True</span>
  <span class="o">-</span> <span class="n">New</span> <span class="n">positions</span>       <span class="p">:</span>  <span class="kc">False</span>
 <span class="n">Visibility</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">Visibility</span> <span class="n">keyword</span> <span class="p">:</span>  <span class="n">strictmoonveto</span>
  <span class="o">-</span>            <span class="nb">range</span>   <span class="p">:</span>  <span class="mf">3.0</span> <span class="n">d</span>
  <span class="o">-</span> <span class="n">Output</span> <span class="n">folder</span>      <span class="p">:</span>  <span class="n">skygen_vis</span>
 <span class="n">Debugging</span> <span class="p">:</span>  <span class="kc">True</span>

<span class="n">Command</span> <span class="n">line</span><span class="p">:</span>
<span class="n">skygen</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">year1</span> <span class="mi">2000</span> <span class="o">--</span><span class="n">nyears</span> <span class="mi">44</span> <span class="o">--</span><span class="n">first</span> <span class="mi">1</span> <span class="o">--</span><span class="n">Nsrc</span> <span class="mi">7</span> <span class="o">--</span><span class="n">version</span> <span class="n">triggers</span> <span class="o">--</span><span class="n">days</span> <span class="mf">3.0</span> <span class="n">d</span> <span class="o">--</span><span class="n">visibility</span> <span class="n">strictmoonveto</span> <span class="o">--</span><span class="n">config</span> <span class="n">data</span><span class="o">/</span><span class="n">config_ref</span><span class="o">.</span><span class="n">yaml</span> <span class="o">--</span><span class="n">output</span> <span class="n">skygen_vis</span> <span class="o">--</span><span class="n">seed</span> <span class="mi">2022</span> <span class="o">--</span><span class="n">debug</span> <span class="o">--</span><span class="n">trigger</span> <span class="o">--</span><span class="n">noposition</span>
<span class="o">--------------------------------------------------</span>
</pre></div>
</div>
<p>In final, the following files are
produced:
<code class="docutils literal notranslate"><span class="pre">skygen_vis//long_1_1000/test_omega/strictmoonveto_2000_44_triggers/DP_strictmoonveto_2000_44_triggers_1_7.yaml</span></code>
<code class="docutils literal notranslate"><span class="pre">skygen_vis//long_1_1000/test_omega/strictmoonveto_2000_44_triggers/strictmoonveto_2000_44_triggers_1_7.json</span></code></p>
<p>Note, the following command where both the dates and positions are recomputed:</p>
<p><code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">skygen.py</span>&#160; <span class="pre">-y</span> <span class="pre">2000</span> <span class="pre">-n</span> <span class="pre">5</span>&#160; <span class="pre">-c</span> <span class="pre">data/config_ref.yaml</span> <span class="pre">--trigger</span> <span class="pre">--position</span> <span class="pre">-v</span> <span class="pre">&quot;allrecomputed&quot;</span></code></p>
<p>has the same effect as omiiting the configuration file with the drawback that
the source file are opened!</p>
</section>
<section id="the-skygen-module">
<h3>The <cite>skygen</cite> module<a class="headerlink" href="#the-skygen-module" title="Permalink to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="skygen.Skies">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">skygen.</span></span><span class="sig-name descname"><span class="pre">Skies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">year1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9999</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nyears</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nsrc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">visibility</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'strictmoonveto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfg_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">WindowsPath('skygen_vis')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2022</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newpos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/skygen.html#Skies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#skygen.Skies" title="Permalink to this definition"></a></dt>
<dd><p>In what follows, the terminology “sky” refers to positions and explosion
dates while visibility gives the source visibility from these parameters
under defined circumstances (e.g: minimal altitude, Moon ligth etc).</p>
<p>This class handles the parameters and function to generate visibilities
from a number of sources within a certain time period defined by 2 years
(from beginning of first year to the end of last year).
The output files are written in a <cite>folder/visibility</cite> subfolder where folder
as a fixed naming convention:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">keyword_year1_Nyears_version</span></code></p>
</div></blockquote>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">keyword</span></code> is one of the dictionnary keyword of the <cite>visibility.yaml</cite>
file or any other keyword (line <cite>forced</cite> or <cite>permanent</cite>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">year1</span></code> is the first year;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Nyears</span></code> the number of years;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">version</span></code> is a version tag to differentiate visibilities generated
from different seeds.</p></li>
</ul>
<p>In this folder two kind of files can be created:</p>
<ul class="simple">
<li><p><cite>yaml</cite> files containing the generated dates and positions. These files
starts with <cite>DP</cite> (for Dates and Position). They can be used to
generate other visibilities from the same dates and position.</p></li>
<li><p><cite>json</cite> file containing the visibility class content of all sources
in the identifier range.</p></li>
</ul>
<p>Both files reproduce the name of the folder above with the source range
added (<cite>id1</cite> and <cite>id2</cite> is the source identifier range):</p>
<ul class="simple">
<li><p>Date and position files: <code class="docutils literal notranslate"><span class="pre">DP_keyword_year1_Nyears_version_id1_id2.yaml</span></code></p></li>
<li><p>Visibility class dump: <code class="docutils literal notranslate"><span class="pre">keyword_year1_Nyears_version_id1_id2.json</span></code></p></li>
</ul>
<p>To produce the visibility files for data with positon and dates defined,
use <code class="docutils literal notranslate"><span class="pre">sky_from_source</span></code> (with the possibility to change the dates).</p>
<dl class="py method">
<dt class="sig sig-object py" id="skygen.Skies.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">year1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9999</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nyears</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nsrc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">visibility</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'strictmoonveto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfg_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">WindowsPath('skygen_vis')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2022</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newpos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/skygen.html#Skies.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#skygen.Skies.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Create de default object from external parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>year1</strong><span class="classifier">integer</span></dt><dd><p>First year. The default if 9999.</p>
</dd>
<dt><strong>nyears</strong><span class="classifier">integer</span></dt><dd><p>Number of years. The default is 1.</p>
</dd>
<dt><strong>first</strong><span class="classifier">integer</span></dt><dd><p>First source identifier. The default is 1.</p>
</dd>
<dt><strong>Nsrc</strong><span class="classifier">integer</span></dt><dd><p>Number of sources. The default is 1.</p>
</dd>
<dt><strong>version</strong><span class="classifier">string, optional</span></dt><dd><p>Visibility version tag, chosen by the user. The default is “1”.</p>
</dd>
<dt><strong>duration</strong><span class="classifier">float, optional</span></dt><dd><p>Duration in days on which the visibility is computed. The default
is 3.0.</p>
</dd>
<dt><strong>visibility</strong><span class="classifier">string, optional</span></dt><dd><p>A dictionnary entry to be found in <cite>visibility.yaml</cite>.
The default is <cite>strictmoonveto</cite>.</p>
</dd>
<dt><strong>cfg_path</strong><span class="classifier">pathlib Path, optional</span></dt><dd><p>Configuration file name full path. The default is ‘congif.yaml’.</p>
</dd>
<dt><strong>output</strong><span class="classifier">pathlib Path, optional</span></dt><dd><p>Output base folder. The default is <cite>Path(“./skygen_vis”)</cite>.</p>
</dd>
<dt><strong>seed</strong><span class="classifier">integer, optional</span></dt><dd><p>Seed for random generator. The default is 2022.</p>
</dd>
<dt><strong>newpos: boolean</strong></dt><dd><p>If True, if the positions are read from source file, the positions
are re-generated isotropically on the sky.</p>
</dd>
<dt><strong>newdate: boolean</strong></dt><dd><p>If True, if the data are read from source file, the dates are
re-generated from the given source range.</p>
</dd>
<dt><strong>debug</strong><span class="classifier">boolean, optional</span></dt><dd><p>If True, print out various information. The default is False.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="skygen.Skies.command_line">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">command_line</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/skygen.html#Skies.command_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#skygen.Skies.command_line" title="Permalink to this definition"></a></dt>
<dd><p>Supersede default argument with the command line arguments and generate
the command line to be further used for Batch submission</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>Skies instance</dt><dd><p>Instance filled with the command line argument values.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="skygen.Skies.create_output_folder">
<span class="sig-name descname"><span class="pre">create_output_folder</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/skygen.html#Skies.create_output_folder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#skygen.Skies.create_output_folder" title="Permalink to this definition"></a></dt>
<dd><p>Create the folder containing the corresponding files</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="skygen.Skies.create_vis">
<span class="sig-name descname"><span class="pre">create_vis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">paramfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'visibility.yaml'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observatory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CTA'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/skygen.html#Skies.create_vis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#skygen.Skies.create_vis" title="Permalink to this definition"></a></dt>
<dd><p>Compute visibilities, store in an array.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="skygen.Skies.generate_dates">
<span class="sig-name descname"><span class="pre">generate_dates</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/skygen.html#Skies.generate_dates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#skygen.Skies.generate_dates" title="Permalink to this definition"></a></dt>
<dd><p>Generate dates in MJD from given year intervall, from January 1st of
the first year at midnight to December 31st of last year at 23:59:59</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="skygen.Skies.generate_positions">
<span class="sig-name descname"><span class="pre">generate_positions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/skygen.html#Skies.generate_positions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#skygen.Skies.generate_positions" title="Permalink to this definition"></a></dt>
<dd><p>Generate random uniform (ra,dec) positons in the sky in degrees.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="skygen.Skies.generate_sky">
<span class="sig-name descname"><span class="pre">generate_sky</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/skygen.html#Skies.generate_sky"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#skygen.Skies.generate_sky" title="Permalink to this definition"></a></dt>
<dd><p>Generate dates and position from the seed.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="skygen.Skies.plot_sky">
<span class="sig-name descname"><span class="pre">plot_sky</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/skygen.html#Skies.plot_sky"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#skygen.Skies.plot_sky" title="Permalink to this definition"></a></dt>
<dd><p>Plot result of the generation of dates and positions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>nbin</strong><span class="classifier">integer, optional</span></dt><dd><p>Number of bins in histograms. The default is 25.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="skygen.Skies.prefix">
<span class="sig-name descname"><span class="pre">prefix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/skygen.html#Skies.prefix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#skygen.Skies.prefix" title="Permalink to this definition"></a></dt>
<dd><p>This create the prefix string of both yaml (DP) and json (visibility)
files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>version</strong><span class="classifier">string, optional</span></dt><dd><p>A version tag from the user. The default is None.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>string</dt><dd><p>The name (no extension) of the yaml and json files.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="skygen.Skies.print">
<span class="sig-name descname"><span class="pre">print</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/skygen.html#Skies.print"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#skygen.Skies.print" title="Permalink to this definition"></a></dt>
<dd><p>Print class contents with comments</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="skygen.Skies.sky_from_source">
<span class="sig-name descname"><span class="pre">sky_from_source</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/skygen.html#Skies.sky_from_source"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#skygen.Skies.sky_from_source" title="Permalink to this definition"></a></dt>
<dd><p>Get the sky positions and dates from original source files when
this information exists.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="skygen.Skies.sky_from_yaml">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sky_from_yaml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/skygen.html#Skies.sky_from_yaml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#skygen.Skies.sky_from_yaml" title="Permalink to this definition"></a></dt>
<dd><p>Read dates and postions from an existing “DP” yaml file.
The dates are stored as mjd in the file and Time object in the
instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename</strong><span class="classifier">pathlib Path</span></dt><dd><p>Input file name.</p>
</dd>
<dt><strong>version: integer</strong></dt><dd><p>New version tag f needed</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>Skies instance</dt><dd><p>New instance.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="skygen.Skies.sky_to_yaml">
<span class="sig-name descname"><span class="pre">sky_to_yaml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/skygen.html#Skies.sky_to_yaml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#skygen.Skies.sky_to_yaml" title="Permalink to this definition"></a></dt>
<dd><p>Dump dates and sky position into a yaml file for further use.
posiitons are stored as they are (float) whereas dates are stored as
modified Julian Days from the original Time object.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>filename: pathlib Path</dt><dd><p>output filename</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="skygen.Skies.vis2json">
<span class="sig-name descname"><span class="pre">vis2json</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/skygen.html#Skies.vis2json"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#skygen.Skies.vis2json" title="Permalink to this definition"></a></dt>
<dd><p>Dump the list of visibility instances to a json file</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="preparing-batch-submissions">
<span id="batch-submission"></span><h2>Preparing batch submissions<a class="headerlink" href="#preparing-batch-submissions" title="Permalink to this heading"></a></h2>
<p>The processing of 1000 GRB files with one iteration per trial and a classical
logarithmic spacing of time slices (ca. 40 slices in total) takes roughly 2
hours on a I5 -16GB laptop, including the visibility computation. With 100
iterations the computing time is only slightly increased. Processing more files
require to use a Batch system.</p>
<section id="the-generator-module">
<h3>The <cite>generator</cite>  module<a class="headerlink" href="#the-generator-module" title="Permalink to this heading"></a></h3>
<p>This module generates automatically a set of commands running over a given
number of source in a certain number of contiguous subsets (e.g. a population
of 100 sources in 10 subsets of 10 sources).
If required these commands are converted into a series of batch commands.</p>
<p>Use <code class="code docutils literal notranslate"><span class="pre">pyhton</span> <span class="pre">generator.py</span> <span class="pre">-h</span></code> in the <cite>SoHAPPy</cite> folder to get the available
options:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">generator</span><span class="o">.</span><span class="n">py</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="o">-</span><span class="n">C</span> <span class="n">CODE</span> <span class="p">[</span><span class="o">-</span><span class="n">P</span> <span class="n">POP</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">S</span> <span class="n">SETS</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">batch</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">nobatch</span><span class="p">]</span>

<span class="n">Generate</span> <span class="n">batch</span> <span class="n">scripts</span> <span class="k">for</span> <span class="n">SoHAPPy</span>

<span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>            <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>
  <span class="o">-</span><span class="n">C</span> <span class="n">CODE</span><span class="p">,</span> <span class="o">--</span><span class="n">Code</span> <span class="n">CODE</span>  <span class="n">Code</span> <span class="n">to</span> <span class="n">be</span> <span class="n">run</span>
  <span class="o">-</span><span class="n">P</span> <span class="n">POP</span><span class="p">,</span> <span class="o">--</span><span class="n">Pop</span> <span class="n">POP</span>     <span class="n">Population</span> <span class="n">statistics</span>
  <span class="o">-</span><span class="n">S</span> <span class="n">SETS</span><span class="p">,</span> <span class="o">--</span><span class="n">Sets</span> <span class="n">SETS</span>  <span class="n">Number</span> <span class="n">of</span> <span class="n">sets</span>
  <span class="o">--</span><span class="n">batch</span>               <span class="n">Create</span> <span class="n">batch</span> <span class="n">commands</span>
  <span class="o">--</span><span class="n">nobatch</span>             <span class="n">Does</span> <span class="ow">not</span> <span class="n">create</span> <span class="n">batch</span> <span class="n">commands</span>
</pre></div>
</div>
<p>Any additionnal option will be send to the code passed in argument. This does
mean that <cite>generator</cite> can only be used with codes accepting options which are
not in the list above. In particular it is compatible with <cite>SoHAPPy</cite> and
<cite>skygen</cite>.</p>
<p>As an example:</p>
<p><code class="code docutils literal notranslate"><span class="pre">python</span> <span class="pre">generator.py</span> <span class="pre">-C</span> <span class="pre">&quot;SoHAPPy.py&quot;</span> <span class="pre">-V</span> <span class="pre">&quot;strictmoonveto&quot;</span> <span class="pre">-P</span> <span class="pre">10</span> <span class="pre">-S</span> <span class="pre">3</span> <span class="pre">--nobatch</span> <span class="pre">-d</span> <span class="pre">0</span></code></p>
<p>will produce 3 commands for launching SoHAPPy on 3 subsets of 10 sources.
Here is the output (note that these commands use the default <cite>config.yaml</cite>
file for most of the parameters, except the one explicitely superseded on the
command line. Here the visibility is computed on-the-fly, based on the
parameters associated to <cite>strictmoonveto</cite> in <code class="xref py py-obj docutils literal notranslate"><span class="pre">visibility.yaml</span></code> ):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SoHAPPy</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">first</span> <span class="mi">1</span> <span class="o">--</span><span class="n">nsrc</span> <span class="mi">3</span> <span class="o">--</span><span class="n">visibility</span> <span class="n">strictmoonveto</span> <span class="o">-</span><span class="n">debug</span> <span class="mi">0</span>
<span class="n">SoHAPPy</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">first</span> <span class="mi">4</span> <span class="o">--</span><span class="n">nsrc</span> <span class="mi">3</span> <span class="o">--</span><span class="n">visibility</span> <span class="n">strictmoonveto</span> <span class="o">-</span><span class="n">debug</span> <span class="mi">0</span>
<span class="n">SoHAPPy</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">first</span> <span class="mi">7</span> <span class="o">--</span><span class="n">nsrc</span> <span class="mi">4</span> <span class="o">--</span><span class="n">visibility</span> <span class="n">strictmoonveto</span> <span class="o">-</span><span class="n">debug</span> <span class="mi">0</span>
</pre></div>
</div>
<p>with the associated batch commands of the kind (example given for the first
line, using <code class="code docutils literal notranslate"><span class="pre">--batch</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sbatch</span> <span class="o">-</span><span class="n">c</span> <span class="mi">1</span> <span class="o">--</span><span class="n">mem</span><span class="o">-</span><span class="n">per</span><span class="o">-</span><span class="n">cpu</span> <span class="mi">2</span><span class="n">G</span> <span class="o">-</span><span class="n">t</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">30</span> <span class="o">-</span><span class="n">J</span> <span class="n">tbd</span> <span class="o">--</span><span class="n">wrap</span> <span class="s1">&#39;SoHAPPy.py --first 1 --nsrc 3 --config &quot;None&quot; --visibility strictmoonveto --debug 0 &#39;</span>
</pre></div>
</div>
<p>The same applies to the <cite>skygen</cite> code with its own options. For instance, let’s
compute the visibilities corresponding to <cite>strictmoonveto</cite> beforehand in order
to use them later:</p>
<p><code class="code docutils literal notranslate"><span class="pre">python</span> <span class="pre">generator.py</span> <span class="pre">-C</span> <span class="pre">&quot;skygen.py&quot;</span> <span class="pre">-V</span> <span class="pre">&quot;strictmoonveto&quot;</span> <span class="pre">-P</span> <span class="pre">10</span> <span class="pre">-S</span> <span class="pre">3</span> <span class="pre">--nobatch</span> <span class="pre">--nodebug</span></code></p>
<p>The output is the following (Note that the positions and the trigger times are
not recomputed and expected to be found in the input files. The implicity paths are replaced by explcit pathes (not shown here). The omitted
parameters are taken from the local <cite>config.yaml</cite> file):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="s2">&quot;skygen.py&quot;</span> <span class="o">--</span><span class="n">year1</span> <span class="mi">9999</span> <span class="o">--</span><span class="n">nyears</span> <span class="mi">1</span> <span class="o">--</span><span class="n">first</span> <span class="mi">1</span> <span class="o">--</span><span class="n">Nsrc</span> <span class="mi">3</span> <span class="o">--</span><span class="n">version</span> <span class="mi">1</span> <span class="o">--</span><span class="n">days</span> <span class="mf">3.0</span> <span class="o">--</span><span class="n">visibility</span> <span class="n">strictmoonveto</span> <span class="o">--</span><span class="n">config</span> <span class="s2">&quot;data\config_ref.yaml&quot;</span> <span class="o">--</span><span class="n">output</span> <span class="s2">&quot;skygen_vis&quot;</span> <span class="o">--</span><span class="n">seed</span> <span class="mi">2022</span> <span class="o">--</span><span class="n">nodebug</span> <span class="o">--</span><span class="n">notrigger</span> <span class="o">--</span><span class="n">noposition</span>
<span class="n">python</span> <span class="s2">&quot;skygen.py&quot;</span> <span class="o">--</span><span class="n">year1</span> <span class="mi">9999</span> <span class="o">--</span><span class="n">nyears</span> <span class="mi">1</span> <span class="o">--</span><span class="n">first</span> <span class="mi">4</span> <span class="o">--</span><span class="n">Nsrc</span> <span class="mi">3</span> <span class="o">--</span><span class="n">version</span> <span class="mi">1</span> <span class="o">--</span><span class="n">days</span> <span class="mf">3.0</span> <span class="o">--</span><span class="n">visibility</span> <span class="n">strictmoonveto</span> <span class="o">--</span><span class="n">config</span> <span class="s2">&quot;data\config_ref.yaml&quot;</span> <span class="o">--</span><span class="n">output</span> <span class="s2">&quot;skygen_vis&quot;</span> <span class="o">--</span><span class="n">seed</span> <span class="mi">2022</span> <span class="o">--</span><span class="n">nodebug</span> <span class="o">--</span><span class="n">notrigger</span> <span class="o">--</span><span class="n">noposition</span>
<span class="n">python</span> <span class="s2">&quot;skygen.py&quot;</span> <span class="o">--</span><span class="n">year1</span> <span class="mi">9999</span> <span class="o">--</span><span class="n">nyears</span> <span class="mi">1</span> <span class="o">--</span><span class="n">first</span> <span class="mi">7</span> <span class="o">--</span><span class="n">Nsrc</span> <span class="mi">4</span> <span class="o">--</span><span class="n">version</span> <span class="mi">1</span> <span class="o">--</span><span class="n">days</span> <span class="mf">3.0</span> <span class="o">--</span><span class="n">visibility</span> <span class="n">strictmoonveto</span> <span class="o">--</span><span class="n">config</span> <span class="s2">&quot;data\config_ref.yaml&quot;</span> <span class="o">--</span><span class="n">output</span> <span class="s2">&quot;skygen_vis&quot;</span> <span class="o">--</span><span class="n">seed</span> <span class="mi">2022</span> <span class="o">--</span><span class="n">nodebug</span> <span class="o">--</span><span class="n">notrigger</span> <span class="o">--</span><span class="n">noposition</span>
</pre></div>
</div>
<p>The output visibility files will be found in the default <cite>skygen_vis</cite> subfolder.</p>
</section>
<section id="module-generator">
<span id="generator-module"></span><h3>generator Module<a class="headerlink" href="#module-generator" title="Permalink to this heading"></a></h3>
<p>This script generates command lines for interactive running and batch
submissions of a series of simulation and analysis based on a large population.
It is written to use the
<a class="reference external" href="https://slurm.schedmd.com/documentation.html">slurm</a> batch system.</p>
<p>Created on Mon Mar  6 09:29:47 2023</p>
<p>&#64;author: Stolar</p>
<section id="functions">
<h4>Functions<a class="headerlink" href="#functions" title="Permalink to this heading"></a></h4>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="api/generator.slurm_cmd.html#generator.slurm_cmd" title="generator.slurm_cmd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">slurm_cmd</span></code></a>(job_cmd[, nproc, mem_per_cpu, ...])</p></td>
<td><p>Note: When run on Spyder, a 1000 source production occupy 1.6 Gb of memory on a classical laptop, thus justifying the <cite>mem_per_cpu</cite> default value.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/generator.decode_command_line.html#generator.decode_command_line" title="generator.decode_command_line"><code class="xref py py-obj docutils literal notranslate"><span class="pre">decode_command_line</span></code></a>()</p></td>
<td><p>Decode the current command line.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="beginning-to-end-example">
<h2>Beginning-to-end example<a class="headerlink" href="#beginning-to-end-example" title="Permalink to this heading"></a></h2>
<p>In this example one use the 1000 long afterglow GRB sample that has been used
in the early studies. The fits files contain the date, the position of the GRB
and a defaulty visibility computed for one night with a default minimal
altitude of 10°.</p>
<p>We first set the input and output folder environment variable <cite>HAPPY_IN</cite> and
<cite>HAPPY_OUT</cite> as explained in the <cite>introduction &lt;introduction.rst&gt;</cite>.</p>
<section id="interactive-test">
<h3>Interactive test<a class="headerlink" href="#interactive-test" title="Permalink to this heading"></a></h3>
<p>We start with an interactive run and a very small sample of 10 sources spread
over 3 sets and generate the visibility with the ‘strictmmoonveto’
configuration. For this we create the correspoding commands to be submitted
with the <cite>–nobatch option</cite>. We explicit the use of the default configuration
file, <cite>dataconfig_ref.yaml</cite> and the fact that the dates and the sky positions
are not re-generated:</p>
<p><code class="code docutils literal notranslate"><span class="pre">python</span> <span class="pre">generator.py</span> <span class="pre">-C</span> <span class="pre">skygen.py</span> <span class="pre">-P</span> <span class="pre">10</span> <span class="pre">-S</span> <span class="pre">3</span> <span class="pre">-V</span> <span class="pre">strictmoonveto</span> <span class="pre">--nobatch</span>&#160; <span class="pre">-v</span> <span class="pre">interactive_test</span> <span class="pre">-c</span> <span class="pre">data/config_ref.yaml</span> <span class="pre">--notrigger</span> <span class="pre">--noposition</span></code></p>
<p>A file is created, named <cite>interactive_skygen_10_3.ps1</cite> (in <cite>Powershell</cite>) that
contains the 3 <cite>SoHAPPy</cite> run commands.
This script can be executed and launches interactively 3 <cite>skygen</cite> runs,
producing <cite>yaml`files with the original sky positions and dates, and a `json</cite>
file with the visibility data. Because no date were generated, the folder and
files use the default year-of-start 9999 and the a number of years equal to 1
(In powershell, use <code class="code docutils literal notranslate"><span class="pre">.interactive_skygen_10_3.ps1</span></code>).</p>
<p>The files are found in :
:code: <code class="docutils literal notranslate"><span class="pre">skygen_vis/long_1_1000/test_omega/strictmoonveto_9999_1_interactive_test\</span></code></p>
<p>and here they are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DP_strictmoonveto_9999_1_interactive_test_1_3</span><span class="o">.</span><span class="n">yaml</span>
<span class="n">DP_strictmoonveto_9999_1_interactive_test_4_6</span><span class="o">.</span><span class="n">yaml</span>
<span class="n">DP_strictmoonveto_9999_1_interactive_test_7_10</span><span class="o">.</span><span class="n">yaml</span>
<span class="n">strictmoonveto_9999_1_interactive_test_1_3</span><span class="o">.</span><span class="n">json</span>
<span class="n">strictmoonveto_9999_1_interactive_test_4_6</span><span class="o">.</span><span class="n">json</span>
<span class="n">strictmoonveto_9999_1_interactive_test_7_10</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p>These files can now be used with <cite>SoHAPPy</cite>. The folder has to be moved to the
<cite>HAPPY_OUT</cite> base folder.
The <cite>SoHAPPy</cite> command can be generated in a similar way, using the same
configuration file, and expliciting the visibility folder created above:</p>
<dl class="field-list simple">
<dt class="field-odd">code</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">generator.py</span> <span class="pre">-C</span> <span class="pre">SoHAPPy</span> <span class="pre">-P</span> <span class="pre">10</span> <span class="pre">-S</span> <span class="pre">3</span> <span class="pre">-V</span> <span class="pre">strictmoonveto_9999_1_interactive_test</span> <span class="pre">--nobatch</span>&#160; <span class="pre">-c</span> <span class="pre">data\config_ref.yaml</span></code></p>
</dd>
</dl>
<p>This gives a series of 3 command lines stored in <cite>interactive_SoHAPPy_10_3.ps1</cite>.
Running them generate 3 folders with names idetical to the <cite>json</cite> files above
(without extension). Each folder contains the <cite>SoHAPPy</cite> results for each
series of visibilities.
Note that the event list processed with <cite>SoHAPPy</cite> for a given visibility set
has to be within the visibility range. It has not to cover the full range.</p>
</section>
<section id="batch-test">
<h3>Batch test<a class="headerlink" href="#batch-test" title="Permalink to this heading"></a></h3>
<p>The process is the same except that the <cite>genrator.py</cite> commands have the
<cite>–batch</cite> option.
Let’s generate the commands to reproduce the simulation and analysis of the
100 long afterglow population with he standard conditions as defined in
<cite>data/config-ref.yaml</cite>.</p>
<p>First we create the visibilities from the trigger date
and sky psoitions in the data file. The informatuion obtained from the
configuration file is only the input data folder. We split the full population
(1000 sources) into 10 sets. Because of the default values, the command
simplifies to:</p>
<dl class="field-list simple">
<dt class="field-odd">code</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">generator.py</span> <span class="pre">-C</span> <span class="pre">skygen.py</span> <span class="pre">-P</span> <span class="pre">1000</span> <span class="pre">-S</span> <span class="pre">10</span> <span class="pre">--batch</span>&#160; <span class="pre">-v</span> <span class="pre">omega_ref</span></code></p>
</dd>
</dl>
<p>The output file <cite>batch_skygen_1000_10.ps1</cite> (<cite>.sh</cite> for a bash system) contains the
command lines of the kind (Note that the visibility is computed up to 3 days,
the default duration):</p>
<dl class="field-list simple">
<dt class="field-odd">code</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">sbatch</span> <span class="pre">-c</span> <span class="pre">1</span> <span class="pre">--mem-per-cpu</span> <span class="pre">2G</span> <span class="pre">-t</span> <span class="pre">00:00:30</span> <span class="pre">-J</span> <span class="pre">SoHAPPy</span> <span class="pre">--wrap</span> <span class="pre">'python</span> <span class="pre">&quot;J:\My</span> <span class="pre">Documents\CTA_Analysis\GRB</span> <span class="pre">paper\SoHAPPy\skygen.py&quot;</span> <span class="pre">--year1</span> <span class="pre">9999</span> <span class="pre">--nyears</span> <span class="pre">1</span> <span class="pre">--first</span> <span class="pre">1</span> <span class="pre">--Nsrc</span> <span class="pre">100</span> <span class="pre">--version</span> <span class="pre">omega_ref</span> <span class="pre">--days</span> <span class="pre">3.0</span> <span class="pre">--visibility</span> <span class="pre">strictmoonveto</span> <span class="pre">--config</span> <span class="pre">&quot;\\dapdc5\Stolar\My</span> <span class="pre">Documents\CTA_Analysis\GRB</span> <span class="pre">paper\SoHAPPy\data\config_ref.yaml&quot;</span> <span class="pre">--output</span> <span class="pre">&quot;J:\My</span> <span class="pre">Documents\CTA_Analysis\GRB</span> <span class="pre">paper\SoHAPPy\skygen_vis&quot;</span> <span class="pre">--seed</span> <span class="pre">2022</span> <span class="pre">--nodebug</span> <span class="pre">--notrigger</span> <span class="pre">--noposition'</span></code></p>
</dd>
</dl>
<p>The batch runs for 6 minutes on the astrophysics CEA DAp cluster (which is 2
times faster than on an I5 laptop for each file, and because of the use of 10
cores in parallel, 20 times faster in total).</p>
<p>The population can then be analysed in the standard conditions using these
visibility and date-position files, once moved to the <cite>HAPPY_OUT</cite>. The batch commands are obtained from:</p>
<dl class="field-list simple">
<dt class="field-odd">code</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">generator.py</span> <span class="pre">-C</span> <span class="pre">SoHAPPy</span> <span class="pre">-P</span> <span class="pre">1000</span> <span class="pre">-S</span> <span class="pre">10</span> <span class="pre">-V</span> <span class="pre">strictmoonveto_9999_1_omega_ref</span> <span class="pre">--batch</span> <span class="pre">-d</span> <span class="pre">0</span></code></p>
</dd>
</dl>
<p>The</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="file_format.html" class="btn btn-neutral float-left" title="Input file format" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="api/generator.slurm_cmd.html" class="btn btn-neutral float-right" title="slurm_cmd" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Th. Stolarczyk.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>